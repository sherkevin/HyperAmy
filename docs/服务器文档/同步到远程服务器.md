# 同步项目到远程服务器

## 远程服务器信息
- **路径**: `/media/data4/jiangh/Amygdala/hyperamy_source`
- **GPU**: 7个GPU可用（RTX 3090 x4, RTX 2080 Ti x2）
- **优势**: GPU加速，适合长时间运行

## 需要同步的内容

### 1. 新创建的实验脚本
- `test/test_rigorous_comparison_save.py` - 严谨对比实验
- `test/test_rigorous_comparison.py` - 标准对比实验
- `scripts/download_hotpotqa.py` - 数据集下载脚本
- `scripts/run_experiment_background.sh` - 后台运行脚本
- `scripts/check_experiment_status.sh` - 状态检查脚本

### 2. 数据集文件
- `hipporag/reproduce/dataset/hotpotqa_corpus.json` - 语料库（991文档）
- `hipporag/reproduce/dataset/hotpotqa.json` - QA数据（100问题）

### 3. 更新的代码（如果有）
- `sentiment/` 模块的最新版本
- 其他更新的文件

## 同步方法

### 方法1: 使用 rsync（推荐）
```bash
# 同步实验脚本和数据集
rsync -avz --progress \
  test/test_rigorous_comparison*.py \
  scripts/download_hotpotqa.py \
  scripts/run_experiment_background.sh \
  scripts/check_experiment_status.sh \
  jiangh@10.103.16.22:/media/data4/jiangh/Amygdala/hyperamy_source/

# 同步数据集
rsync -avz --progress \
  hipporag/reproduce/dataset/hotpotqa*.json \
  jiangh@10.103.16.22:/media/data4/jiangh/Amygdala/hyperamy_source/hipporag/reproduce/dataset/

# 同步sentiment模块（如果需要）
rsync -avz --progress \
  sentiment/ \
  jiangh@10.103.16.22:/media/data4/jiangh/Amygdala/hyperamy_source/sentiment/
```

### 方法2: 使用 scp
```bash
# 同步文件
scp test/test_rigorous_comparison_save.py \
    scripts/download_hotpotqa.py \
    jiangh@10.103.16.22:/media/data4/jiangh/Amygdala/hyperamy_source/test/

scp hipporag/reproduce/dataset/hotpotqa*.json \
    jiangh@10.103.16.22:/media/data4/jiangh/Amygdala/hyperamy_source/hipporag/reproduce/dataset/
```

### 方法3: 使用 git（如果远程是git仓库）
```bash
# 在本地提交更改
git add test/ scripts/ hipporag/reproduce/dataset/
git commit -m "Add rigorous experiment scripts and HotpotQA dataset"
git push

# 在远程服务器上拉取
ssh jiangh@10.103.16.22 "cd /media/data4/jiangh/Amygdala/hyperamy_source && git pull"
```

## 在远程服务器上运行实验

### 1. SSH连接到服务器
```bash
ssh jiangh@10.103.16.22
cd /media/data4/jiangh/Amygdala/hyperamy_source
```

### 2. 检查环境
```bash
# 检查Python环境
python3 --version
which python3

# 检查GPU
nvidia-smi

# 检查依赖
pip list | grep -E "(torch|numpy|pandas)"
```

### 3. 运行实验
```bash
# 使用screen保持会话
screen -S experiment

# 运行实验
python3 -m test.test_rigorous_comparison_save

# 按 Ctrl+A 然后 D 来detach
```

### 4. 监控实验
```bash
# 重新连接screen
screen -r experiment

# 或查看日志
tail -f outputs/rigorous_experiment/logs/experiment_*.log
```

## 优势

1. **GPU加速**: 7个GPU可用，可以加速模型推理
2. **显存充足**: 大部分GPU显存空闲
3. **网络稳定**: 服务器环境，适合长时间运行
4. **无需保持本地电脑开机**: 在服务器上运行

## 注意事项

1. 确保远程服务器上的环境配置正确（.env文件等）
2. 确保API密钥在远程服务器上可用
3. 检查远程服务器上的Python版本和依赖
4. 确保有足够的磁盘空间存储结果

