# 严谨实验执行指南

## 当前状态

### ✅ 已完成
1. **标准数据集准备**: HotpotQA (991文档, 100问题)
2. **数据格式转换**: 已转换为项目格式
3. **实验脚本准备**: 已创建严谨对比实验脚本

### 📋 待执行
4. **运行严谨对比实验**（预计需要数小时）

## 数据集信息

- **数据集**: HotpotQA (HuggingFace)
- **规模**: 991 个文档，100 个问题
- **标注**: 包含真实的相关文档标注（supporting_facts）
- **位置**: `hipporag/reproduce/dataset/`

## 实验脚本

### 选项 1: 完整实验（推荐，支持断点续传）
```bash
python -m test.test_rigorous_comparison_save
```

**特点**:
- ✅ 支持断点续传（如果中断可以继续）
- ✅ 自动保存中间结果
- ✅ 如果结果已存在会跳过

### 选项 2: 标准实验
```bash
python -m test.test_rigorous_comparison
```

## 实验配置

- **查询数量**: 30 个（可在脚本中调整 `MAX_QUERIES`）
- **检索 Top-K**: 5
- **情感权重**: 0.3 (30% 情感，70% 语义)
- **评估指标**: Recall@K (K=1,5,10), MRR

## 预计运行时间

### Baseline
- 索引: ~30-60 分钟（991 个文档）
- 检索: ~10-20 分钟（30 个查询）

### 情感增强版本
- 情感向量提取: ~40-80 分钟（991 个文档）
- 索引: ~30-60 分钟
- 检索: ~15-30 分钟（包含情感增强）

**总计**: 约 2-4 小时

## 执行步骤

### 步骤 1: 运行实验
```bash
cd /Users/ginger/Desktop/学术教育/科研计划/nips/HyperAmy
python -m test.test_rigorous_comparison_save
```

### 步骤 2: 监控进度
- 实验会输出详细的进度信息
- 中间结果会自动保存
- 如果中断，重新运行会从断点继续

### 步骤 3: 查看结果
结果保存在: `outputs/rigorous_experiment/`
- `baseline_results.json` - Baseline 结果
- `enhanced_results.json` - 情感增强结果
- `comparison_results.json` - 对比结果

## 结果解读

### 评估指标
- **Recall@K**: 检索到的相关文档比例（越高越好）
- **MRR**: 平均倒数排名（越高越好）

### 改进幅度
- **绝对值**: 提升的绝对数值
- **相对值**: 提升的百分比

### 统计显著性
- **p-value < 0.05**: 结果具有统计显著性
- **置信区间**: 95% 置信区间

## 注意事项

1. **运行时间**: 实验需要较长时间，建议在后台运行
2. **API 限制**: 注意 API 调用频率限制
3. **结果保存**: 确保有足够的磁盘空间
4. **中断恢复**: 如果中断，重新运行会自动继续

## 快速测试（可选）

如果想快速验证，可以先使用更小的样本：
```python
MAX_QUERIES = 10  # 在脚本中修改
```

## 下一步

实验完成后：
1. 分析结果
2. 进行统计显著性检验
3. 生成实验报告
4. 如果效果好，扩展到全部 100 个查询

