WARNING 12-29 16:18:13 [importing.py:53] Triton is installed, but `triton.backends` could not be imported. Disabling Triton.
INFO 12-29 16:18:13 [importing.py:68] Triton not installed or not compatible; certain GPU-related functions will not be available.
[2025-12-29 16:18:24] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_basic
[2025-12-29 16:18:25] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:18:29] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:18:29] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:18:30] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:18:30] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:18:30] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:18:30] INFO speed.py:22: Speed module initialized
[2025-12-29 16:18:30] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:18:30] INFO particle.py:79: Particle module initialized
[2025-12-29 16:18:30] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:18:30] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:18:31] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_basic, collection=test_particles_basic
[2025-12-29 16:18:31] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_basic, collection=test_particles_basic
[2025-12-29 16:18:31] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_basic
[2025-12-29 16:18:31] INFO amygdala.py:39: Creating working directory: test_amygdala_basic/conversation_embeddings
[2025-12-29 16:18:32] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:18:32] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:18:32] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:18:32] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:18:32] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:18:32] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:18:32] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming and I'm excited about machine learning!
[2025-12-29 16:18:32] INFO amygdala.py:300:   输入 - conversation_length: 65 字符
[2025-12-29 16:18:32] INFO particle.py:100: ================================================================================
[2025-12-29 16:18:32] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:18:32] INFO particle.py:102:   输入 - text_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:18:32] INFO particle.py:103:   输入 - text: I love Python programming and I'm excited about machine learning!
[2025-12-29 16:18:32] INFO particle.py:104:   输入 - text_length: 65 字符
[2025-12-29 16:18:32] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:18:32] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:18:32] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:18:32] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:18:32] INFO emotion_v2.py:168:   输入 - text: I love Python programming and I'm excited about machine learning!
[2025-12-29 16:18:32] INFO emotion_v2.py:169:   输入 - text_length: 65 字符
[2025-12-29 16:18:32] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:18:32] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:21:06] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:21:06] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:21:06] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:21:06] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:21:06] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:21:06] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:21:06] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:21:07] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, joy, enthusiasm, admiration
[2025-12-29 16:21:07] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:21:08] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, excitement, admiration
[2025-12-29 16:21:08] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'machine learning' 生成情感描述
[2025-12-29 16:21:08] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, hope, admiration, joy
[2025-12-29 16:21:08] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:21:08] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:21:08] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:21:08] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:21:09] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:09] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:10] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:10] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:21:10] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:21:10] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:21:10] INFO emotion_v2.py:277:     1. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:21:10] INFO emotion_v2.py:277:     2. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:21:10] INFO emotion_v2.py:277:     3. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:21:10] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:21:10] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:21:10] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:21:10] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:21:10] INFO particle.py:119:     1. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:21:10] INFO particle.py:119:     2. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:21:10] INFO particle.py:119:     3. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:21:10] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:21:10] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:21:10] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:21:10] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0191201253334214, 0.010371714180864475, -0.017431453303973922, -0.0026582966463560235, -0.004747347082785393], born=1766996312.1415834
[2025-12-29 16:21:10] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0199887532566355, 0.009433468121116248, -0.02226638228587797, 0.003017010038735376, -0.0002225576028574159], born=1766996312.1415834
[2025-12-29 16:21:10] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01858969826548297, 0.0053837620768865165, -0.03421138648857923, 0.0023874338340953904, -0.015780285225361214], born=1766996312.1415834
[2025-12-29 16:21:10] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:21:10] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:21:10] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2']
[2025-12-29 16:21:15] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:21:15] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:21:15] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:21:15] INFO amygdala.py:399:   conversation_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:21:15] INFO amygdala.py:400:   对话内容长度: 65 字符
[2025-12-29 16:21:15] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:21:15] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:21:15] INFO amygdala.py:107:   文本 1: I love Python programming and I'm excited about machine learning! (长度: 65 字符)
[2025-12-29 16:21:15] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:21:15] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:21:15] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:21:16] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_basic/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:21:16] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:21:16] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:21:16] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:21:16] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:21:16] INFO amygdala.py:428:   对话ID: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:21:16] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:21:16] INFO amygdala.py:430:   关系映射详情: {'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0': 'test_conversation-a303c4404f2ed0d8ad548c735f18a136', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1': 'test_conversation-a303c4404f2ed0d8ad548c735f18a136', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2': 'test_conversation-a303c4404f2ed0d8ad548c735f18a136'}
[2025-12-29 16:21:16] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:21:16] INFO amygdala.py:442:   对话ID: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:21:16] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:21:16] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2']
[2025-12-29 16:21:16] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:21:16] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:21:16] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_multiple
[2025-12-29 16:21:16] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:21:16] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:21:16] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:21:16] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:21:16] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:21:16] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:21:16] INFO speed.py:22: Speed module initialized
[2025-12-29 16:21:16] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:21:16] INFO particle.py:79: Particle module initialized
[2025-12-29 16:21:16] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:21:17] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:21:17] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_multiple, collection=test_particles_multiple
[2025-12-29 16:21:17] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_multiple, collection=test_particles_multiple
[2025-12-29 16:21:17] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_multiple
[2025-12-29 16:21:17] INFO amygdala.py:39: Creating working directory: test_amygdala_multiple/conversation_embeddings
[2025-12-29 16:21:17] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:21:17] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:21:17] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:21:17] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:21:17] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:21:17] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:17] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming and machine learning!
[2025-12-29 16:21:17] INFO amygdala.py:300:   输入 - conversation_length: 47 字符
[2025-12-29 16:21:17] INFO particle.py:100: ================================================================================
[2025-12-29 16:21:17] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:21:17] INFO particle.py:102:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:17] INFO particle.py:103:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:21:17] INFO particle.py:104:   输入 - text_length: 47 字符
[2025-12-29 16:21:17] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:17] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:21:17] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:21:17] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:17] INFO emotion_v2.py:168:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:21:17] INFO emotion_v2.py:169:   输入 - text_length: 47 字符
[2025-12-29 16:21:17] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:17] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:21:19] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:21:19] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:21:19] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:21:19] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:21:19] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:21:19] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:21:19] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:21:20] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, enthusiasm, passion
[2025-12-29 16:21:20] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:21:21] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: love, joy, enthusiasm, admiration, excitement
[2025-12-29 16:21:21] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'machine learning' 生成情感描述
[2025-12-29 16:21:22] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, enthusiasm, joy, passion
[2025-12-29 16:21:22] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:21:22] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:21:22] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:21:22] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:21:23] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:23] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:24] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:24] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:21:24] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:21:24] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:21:24] INFO emotion_v2.py:277:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:21:24] INFO emotion_v2.py:277:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:21:24] INFO emotion_v2.py:277:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:21:24] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:21:24] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:21:24] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:21:24] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:21:24] INFO particle.py:119:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:21:24] INFO particle.py:119:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:21:24] INFO particle.py:119:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:21:24] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:24] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:21:24] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:21:24] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.014658516539968048, 0.014200438554344027, -0.03615469386534805, 0.012837375097121394, -0.008139275744563041], born=1766996477.6138666
[2025-12-29 16:21:24] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.022850304122478588, 0.008097003689050346, -0.03290175873647205, 0.013267918490471438, -0.006014119769039447], born=1766996477.6138666
[2025-12-29 16:21:24] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01303665749331588, 0.014077351452868158, -0.034622678654351285, 0.011173478565730392, -0.008347936675548203], born=1766996477.6138666
[2025-12-29 16:21:24] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:21:24] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:21:24] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:21:28] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:21:28] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:21:28] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:21:28] INFO amygdala.py:399:   conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:28] INFO amygdala.py:400:   对话内容长度: 47 字符
[2025-12-29 16:21:28] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:21:28] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:21:28] INFO amygdala.py:107:   文本 1: I love Python programming and machine learning! (长度: 47 字符)
[2025-12-29 16:21:28] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:21:28] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:21:28] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:21:28] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:21:28] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:21:28] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:28] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:21:28] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:21:28] INFO amygdala.py:428:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:28] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:21:28] INFO amygdala.py:430:   关系映射详情: {'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e'}
[2025-12-29 16:21:28] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:21:28] INFO amygdala.py:442:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:21:28] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:21:28] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:21:28] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:21:28] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:21:28] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:21:28] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:21:28] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:28] INFO amygdala.py:299:   输入 - conversation_text: The weather is beautiful today, I feel happy.
[2025-12-29 16:21:28] INFO amygdala.py:300:   输入 - conversation_length: 45 字符
[2025-12-29 16:21:28] INFO particle.py:100: ================================================================================
[2025-12-29 16:21:28] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:21:28] INFO particle.py:102:   输入 - text_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:28] INFO particle.py:103:   输入 - text: The weather is beautiful today, I feel happy.
[2025-12-29 16:21:28] INFO particle.py:104:   输入 - text_length: 45 字符
[2025-12-29 16:21:28] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:28] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:21:28] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:21:28] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:28] INFO emotion_v2.py:168:   输入 - text: The weather is beautiful today, I feel happy.
[2025-12-29 16:21:28] INFO emotion_v2.py:169:   输入 - text_length: 45 字符
[2025-12-29 16:21:28] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:28] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:21:30] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:21:30] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:21:30] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather', 'beautiful', 'happy']
[2025-12-29 16:21:30] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:21:30] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:21:30] INFO emotion_v2.py:202:   实体列表: ['weather', 'beautiful', 'happy']
[2025-12-29 16:21:30] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:21:31] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, happiness
[2025-12-29 16:21:31] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'beautiful' 生成情感描述
[2025-12-29 16:21:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, happiness, admiration, contentment, delight
[2025-12-29 16:21:32] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'happy' 生成情感描述
[2025-12-29 16:21:33] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, satisfaction, delight
[2025-12-29 16:21:33] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:21:33] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:21:33] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:21:33] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:21:33] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:34] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:34] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:34] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:21:34] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:21:34] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:21:34] INFO emotion_v2.py:277:     1. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:21:34] INFO emotion_v2.py:277:     2. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:21:34] INFO emotion_v2.py:277:     3. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, vector_shape=(2048,)
[2025-12-29 16:21:34] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:21:34] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:21:34] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:21:34] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:21:34] INFO particle.py:119:     1. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:21:34] INFO particle.py:119:     2. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:21:34] INFO particle.py:119:     3. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, vector_shape=(2048,)
[2025-12-29 16:21:34] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:34] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:21:34] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:21:34] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.007425418608170532, 0.0035828943039424247, -0.02242049602467031, 0.0147123680161887, -0.008879347009770356], born=1766996488.6685617
[2025-12-29 16:21:34] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01936803350675633, 0.012348670185517718, -0.022680541422397043, 0.011920522696421305, -5.9944148473408685e-05], born=1766996488.6685617
[2025-12-29 16:21:34] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.021096239933821783, 0.013139088958783107, -0.016996751946681744, 0.01570702695072757, -0.004424798286119552], born=1766996488.6685617
[2025-12-29 16:21:34] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:21:34] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:21:34] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2']
[2025-12-29 16:21:36] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:21:36] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:21:36] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:21:36] INFO amygdala.py:399:   conversation_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:36] INFO amygdala.py:400:   对话内容长度: 45 字符
[2025-12-29 16:21:36] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:21:36] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:21:36] INFO amygdala.py:107:   文本 1: The weather is beautiful today, I feel happy. (长度: 45 字符)
[2025-12-29 16:21:36] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:21:36] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:21:36] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:21:36] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:21:36] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:21:36] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:36] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:21:36] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:21:36] INFO amygdala.py:428:   对话ID: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:36] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:21:36] INFO amygdala.py:430:   关系映射详情: {'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0': 'test_conversation-83524becd2b7394577cc4ea2e2f8d724', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1': 'test_conversation-83524becd2b7394577cc4ea2e2f8d724', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2': 'test_conversation-83524becd2b7394577cc4ea2e2f8d724'}
[2025-12-29 16:21:36] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:21:36] INFO amygdala.py:442:   对话ID: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:21:36] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:21:36] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2']
[2025-12-29 16:21:36] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:21:36] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:21:36] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:21:36] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:21:36] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:36] INFO amygdala.py:299:   输入 - conversation_text: I'm frustrated with this bug in my code.
[2025-12-29 16:21:36] INFO amygdala.py:300:   输入 - conversation_length: 40 字符
[2025-12-29 16:21:36] INFO particle.py:100: ================================================================================
[2025-12-29 16:21:36] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:21:36] INFO particle.py:102:   输入 - text_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:36] INFO particle.py:103:   输入 - text: I'm frustrated with this bug in my code.
[2025-12-29 16:21:36] INFO particle.py:104:   输入 - text_length: 40 字符
[2025-12-29 16:21:36] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:36] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:21:36] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:21:36] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:36] INFO emotion_v2.py:168:   输入 - text: I'm frustrated with this bug in my code.
[2025-12-29 16:21:36] INFO emotion_v2.py:169:   输入 - text_length: 40 字符
[2025-12-29 16:21:36] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:36] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:21:37] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:21:37] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:21:37] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['frustrated', 'bug', 'code']
[2025-12-29 16:21:37] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:21:37] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:21:37] INFO emotion_v2.py:202:   实体列表: ['frustrated', 'bug', 'code']
[2025-12-29 16:21:37] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'frustrated' 生成情感描述
[2025-12-29 16:21:43] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, irritation, annoyance, helplessness, disappointment
[2025-12-29 16:21:43] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'bug' 生成情感描述
[2025-12-29 16:21:45] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, annoyance, distress, irritation
[2025-12-29 16:21:45] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'code' 生成情感描述
[2025-12-29 16:21:45] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, annoyance, disappointment
[2025-12-29 16:21:45] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:21:45] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:21:45] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:21:45] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:21:46] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:47] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:47] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:21:47] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:21:47] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:21:47] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:21:47] INFO emotion_v2.py:277:     1. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, vector_shape=(2048,)
[2025-12-29 16:21:47] INFO emotion_v2.py:277:     2. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, vector_shape=(2048,)
[2025-12-29 16:21:47] INFO emotion_v2.py:277:     3. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, vector_shape=(2048,)
[2025-12-29 16:21:47] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:21:47] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:21:47] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:21:47] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:21:47] INFO particle.py:119:     1. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, vector_shape=(2048,)
[2025-12-29 16:21:47] INFO particle.py:119:     2. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, vector_shape=(2048,)
[2025-12-29 16:21:47] INFO particle.py:119:     3. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, vector_shape=(2048,)
[2025-12-29 16:21:47] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:47] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:21:47] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:21:47] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.00489281586784172, 0.03009893318700737, -0.035084504052343715, 0.028916309218950848, 0.0008145030779997186], born=1766996496.8795643
[2025-12-29 16:21:47] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.007551431858179322, 0.025989931544409303, -0.018231073381885034, 0.01700894235628514, 0.0019299038404255624], born=1766996496.8795643
[2025-12-29 16:21:47] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.007579167785134892, 0.02101766040416125, -0.033614024047061486, 0.024504789305303122, -0.0063278338206095], born=1766996496.8795643
[2025-12-29 16:21:47] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:21:47] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:21:47] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-028403027411873a0426c8a1906d39af_entity_0', 'test_conversation-028403027411873a0426c8a1906d39af_entity_1', 'test_conversation-028403027411873a0426c8a1906d39af_entity_2']
[2025-12-29 16:21:50] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:21:50] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:21:50] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:21:50] INFO amygdala.py:399:   conversation_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:50] INFO amygdala.py:400:   对话内容长度: 40 字符
[2025-12-29 16:21:50] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:21:50] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:21:50] INFO amygdala.py:107:   文本 1: I'm frustrated with this bug in my code. (长度: 40 字符)
[2025-12-29 16:21:50] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:21:50] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:21:50] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:21:50] INFO amygdala.py:95: Saved 3 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:21:50] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 3
[2025-12-29 16:21:50] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:50] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:21:50] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:21:50] INFO amygdala.py:428:   对话ID: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:50] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:21:50] INFO amygdala.py:430:   关系映射详情: {'test_conversation-028403027411873a0426c8a1906d39af_entity_0': 'test_conversation-028403027411873a0426c8a1906d39af', 'test_conversation-028403027411873a0426c8a1906d39af_entity_1': 'test_conversation-028403027411873a0426c8a1906d39af', 'test_conversation-028403027411873a0426c8a1906d39af_entity_2': 'test_conversation-028403027411873a0426c8a1906d39af'}
[2025-12-29 16:21:51] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:21:51] INFO amygdala.py:442:   对话ID: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:21:51] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:21:51] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-028403027411873a0426c8a1906d39af_entity_0', 'test_conversation-028403027411873a0426c8a1906d39af_entity_1', 'test_conversation-028403027411873a0426c8a1906d39af_entity_2']
[2025-12-29 16:21:51] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:21:51] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:21:51] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:21:51] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:21:51] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:21:51] INFO amygdala.py:299:   输入 - conversation_text: Learning new technologies is exciting and challenging.
[2025-12-29 16:21:51] INFO amygdala.py:300:   输入 - conversation_length: 54 字符
[2025-12-29 16:21:51] INFO particle.py:100: ================================================================================
[2025-12-29 16:21:51] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:21:51] INFO particle.py:102:   输入 - text_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:21:51] INFO particle.py:103:   输入 - text: Learning new technologies is exciting and challenging.
[2025-12-29 16:21:51] INFO particle.py:104:   输入 - text_length: 54 字符
[2025-12-29 16:21:51] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:51] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:21:51] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:21:51] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:21:51] INFO emotion_v2.py:168:   输入 - text: Learning new technologies is exciting and challenging.
[2025-12-29 16:21:51] INFO emotion_v2.py:169:   输入 - text_length: 54 字符
[2025-12-29 16:21:51] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:21:51] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:21:52] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:21:52] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 4
[2025-12-29 16:21:52] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['learning', 'technologies', 'exciting', 'challenging']
[2025-12-29 16:21:52] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:21:52] INFO emotion_v2.py:201:   实体数量: 4
[2025-12-29 16:21:52] INFO emotion_v2.py:202:   实体列表: ['learning', 'technologies', 'exciting', 'challenging']
[2025-12-29 16:21:52] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'learning' 生成情感描述
[2025-12-29 16:22:21] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, challenge, anticipation
[2025-12-29 16:22:21] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'technologies' 生成情感描述
[2025-12-29 16:22:50] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, challenge
[2025-12-29 16:22:50] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'exciting' 生成情感描述
[2025-12-29 16:23:23] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, anticipation, curiosity, enthusiasm, eagerness
[2025-12-29 16:23:23] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'challenging' 生成情感描述
[2025-12-29 16:24:19] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, determination, apprehension, hope, pride
[2025-12-29 16:24:19] INFO sentence.py:120: Generated 4 affective descriptions for 4 entities
[2025-12-29 16:24:19] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:24:19] INFO emotion_v2.py:210:   成功生成: 4/4 个描述
[2025-12-29 16:24:19] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:24:21] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:24:21] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:24:22] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:24:22] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:24:22] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:24:22] INFO emotion_v2.py:274:   成功处理: 4/4 个实体
[2025-12-29 16:24:22] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:24:22] INFO emotion_v2.py:277:     1. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO emotion_v2.py:277:     2. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO emotion_v2.py:277:     3. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO emotion_v2.py:277:     4. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:24:22] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:24:22] INFO particle.py:115:   提取结果 - emotion_nodes数量: 4
[2025-12-29 16:24:22] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:24:22] INFO particle.py:119:     1. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO particle.py:119:     2. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO particle.py:119:     3. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO particle.py:119:     4. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, vector_shape=(2048,)
[2025-12-29 16:24:22] INFO particle.py:201: Successfully created 4 particles for text_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:24:22] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 4 个粒子
[2025-12-29 16:24:22] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:24:22] INFO amygdala.py:316:   粒子 1/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016822722024431375, 0.009140268013274269, -0.037232130054071645, 0.006294058009140763, -0.01589712502308715], born=1766996511.408677
[2025-12-29 16:24:22] INFO amygdala.py:316:   粒子 2/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02006239831252087, -0.0016287470253717143, -0.036808506573382416, 0.0007191917512031687, -0.01658146625829685], born=1766996511.408677
[2025-12-29 16:24:22] INFO amygdala.py:316:   粒子 3/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.002043436299108602, 0.023433925989777536, -0.026874362988276727, 0.002374767598964067, -0.013274896994209157], born=1766996511.408677
[2025-12-29 16:24:22] INFO amygdala.py:316:   粒子 4/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0001563295110475571, 0.006610204544294687, -0.03571081523929659, 0.008731306058508094, -0.019449040130327156], born=1766996511.408677
[2025-12-29 16:24:22] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:24:22] INFO amygdala.py:378:   粒子数量: 4
[2025-12-29 16:24:22] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-e05db879cb2c698162903b78288164db_entity_0', 'test_conversation-e05db879cb2c698162903b78288164db_entity_1', 'test_conversation-e05db879cb2c698162903b78288164db_entity_2', 'test_conversation-e05db879cb2c698162903b78288164db_entity_3']
[2025-12-29 16:24:23] INFO storage.py:128: Batch upserted 4 entities
[2025-12-29 16:24:23] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 4 个粒子已存储到数据库
[2025-12-29 16:24:23] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:24:23] INFO amygdala.py:399:   conversation_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:24:23] INFO amygdala.py:400:   对话内容长度: 54 字符
[2025-12-29 16:24:23] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:24:23] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:24:23] INFO amygdala.py:107:   文本 1: Learning new technologies is exciting and challenging. (长度: 54 字符)
[2025-12-29 16:24:23] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:24:23] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:24:23] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:24:23] INFO amygdala.py:95: Saved 4 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:24:23] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 4
[2025-12-29 16:24:23] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:24:23] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:24:23] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:24:23] INFO amygdala.py:428:   对话ID: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:24:23] INFO amygdala.py:429:   关联粒子数: 4
[2025-12-29 16:24:23] INFO amygdala.py:430:   关系映射详情: {'test_conversation-e05db879cb2c698162903b78288164db_entity_0': 'test_conversation-e05db879cb2c698162903b78288164db', 'test_conversation-e05db879cb2c698162903b78288164db_entity_1': 'test_conversation-e05db879cb2c698162903b78288164db', 'test_conversation-e05db879cb2c698162903b78288164db_entity_2': 'test_conversation-e05db879cb2c698162903b78288164db', 'test_conversation-e05db879cb2c698162903b78288164db_entity_3': 'test_conversation-e05db879cb2c698162903b78288164db'}
[2025-12-29 16:24:24] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:24:24] INFO amygdala.py:442:   对话ID: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:24:24] INFO amygdala.py:443:   生成粒子数: 4
[2025-12-29 16:24:24] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-e05db879cb2c698162903b78288164db_entity_0', 'test_conversation-e05db879cb2c698162903b78288164db_entity_1', 'test_conversation-e05db879cb2c698162903b78288164db_entity_2', 'test_conversation-e05db879cb2c698162903b78288164db_entity_3']
[2025-12-29 16:24:24] INFO amygdala.py:445:   关系映射数: 4
[2025-12-29 16:24:24] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:24:24] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_relationship
[2025-12-29 16:24:24] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:24:24] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:24:24] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:24:24] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:24:24] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:24:24] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:24:24] INFO speed.py:22: Speed module initialized
[2025-12-29 16:24:24] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:24:24] INFO particle.py:79: Particle module initialized
[2025-12-29 16:24:24] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:24:24] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:24:27] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_relationship, collection=test_particles_relationship
[2025-12-29 16:24:27] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_relationship, collection=test_particles_relationship
[2025-12-29 16:24:27] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_relationship
[2025-12-29 16:24:27] INFO amygdala.py:39: Creating working directory: test_amygdala_relationship/conversation_embeddings
[2025-12-29 16:24:27] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:24:27] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:24:27] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:24:27] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:24:27] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:24:27] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:27] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming!
[2025-12-29 16:24:27] INFO amygdala.py:300:   输入 - conversation_length: 26 字符
[2025-12-29 16:24:27] INFO particle.py:100: ================================================================================
[2025-12-29 16:24:27] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:24:27] INFO particle.py:102:   输入 - text_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:27] INFO particle.py:103:   输入 - text: I love Python programming!
[2025-12-29 16:24:27] INFO particle.py:104:   输入 - text_length: 26 字符
[2025-12-29 16:24:27] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:24:27] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:24:27] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:24:27] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:27] INFO emotion_v2.py:168:   输入 - text: I love Python programming!
[2025-12-29 16:24:27] INFO emotion_v2.py:169:   输入 - text_length: 26 字符
[2025-12-29 16:24:27] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:24:27] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:24:28] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:24:28] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:24:28] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming']
[2025-12-29 16:24:28] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:24:28] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:24:28] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming']
[2025-12-29 16:24:28] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:24:39] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, love, enthusiasm, admiration
[2025-12-29 16:24:39] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:24:43] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: love, joy, admiration, pride, enthusiasm
[2025-12-29 16:24:43] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:24:43] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:24:43] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:24:43] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:24:43] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:24:44] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:24:44] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:24:44] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:24:44] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:24:44] INFO emotion_v2.py:277:     1. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:24:44] INFO emotion_v2.py:277:     2. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:24:44] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:24:44] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:24:44] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:24:44] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:24:44] INFO particle.py:119:     1. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:24:44] INFO particle.py:119:     2. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:24:44] INFO particle.py:201: Successfully created 2 particles for text_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:44] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:24:44] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:24:44] INFO amygdala.py:316:   粒子 1/2: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.014853580367873714, 0.010374567256943476, -0.03296462481642396, 0.014498012359067478, -0.002347037758128308], born=1766996667.8886123
[2025-12-29 16:24:44] INFO amygdala.py:316:   粒子 2/2: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.022506265408904224, 0.006606568720031192, -0.04016883772980599, 0.017707631321720426, -0.004823978087644261], born=1766996667.8886123
[2025-12-29 16:24:44] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:24:44] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:24:44] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0', 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1']
[2025-12-29 16:24:53] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:24:53] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:24:53] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:24:53] INFO amygdala.py:399:   conversation_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:53] INFO amygdala.py:400:   对话内容长度: 26 字符
[2025-12-29 16:24:53] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:24:53] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:24:53] INFO amygdala.py:107:   文本 1: I love Python programming! (长度: 26 字符)
[2025-12-29 16:24:53] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:24:53] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:24:53] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:24:54] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_relationship/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:24:54] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:24:54] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:54] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:24:54] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:24:54] INFO amygdala.py:428:   对话ID: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:54] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:24:54] INFO amygdala.py:430:   关系映射详情: {'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0': 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2', 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1': 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2'}
[2025-12-29 16:24:55] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:24:55] INFO amygdala.py:442:   对话ID: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:24:55] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:24:55] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0', 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1']
[2025-12-29 16:24:55] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:24:55] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:24:55] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:24:55] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:24:55] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:24:55] INFO amygdala.py:299:   输入 - conversation_text: The weather is beautiful today.
[2025-12-29 16:24:55] INFO amygdala.py:300:   输入 - conversation_length: 31 字符
[2025-12-29 16:24:55] INFO particle.py:100: ================================================================================
[2025-12-29 16:24:55] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:24:55] INFO particle.py:102:   输入 - text_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:24:55] INFO particle.py:103:   输入 - text: The weather is beautiful today.
[2025-12-29 16:24:55] INFO particle.py:104:   输入 - text_length: 31 字符
[2025-12-29 16:24:55] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:24:55] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:24:55] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:24:55] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:24:55] INFO emotion_v2.py:168:   输入 - text: The weather is beautiful today.
[2025-12-29 16:24:55] INFO emotion_v2.py:169:   输入 - text_length: 31 字符
[2025-12-29 16:24:55] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:24:55] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:24:55] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:24:55] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:24:55] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:24:55] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:24:55] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:24:55] INFO emotion_v2.py:202:   实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:24:55] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:24:57] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, admiration, contentment, happiness
[2025-12-29 16:24:57] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'beautiful' 生成情感描述
[2025-12-29 16:25:00] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, admiration, contentment, serenity, appreciation
[2025-12-29 16:25:00] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'today' 生成情感描述
[2025-12-29 16:25:07] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, appreciation, serenity, satisfaction, optimism
[2025-12-29 16:25:07] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:25:07] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:25:07] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:25:07] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:25:08] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:09] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:09] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:09] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:25:09] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:25:09] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:25:09] INFO emotion_v2.py:277:     1. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:25:09] INFO emotion_v2.py:277:     2. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:25:09] INFO emotion_v2.py:277:     3. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:25:09] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:25:09] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:25:09] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:25:09] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:25:09] INFO particle.py:119:     1. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:25:09] INFO particle.py:119:     2. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:25:09] INFO particle.py:119:     3. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:25:09] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:25:09] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:25:09] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:25:09] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02356536223034282, 0.021463341298995936, -0.027723956094520948, 0.01519136450384201, -0.0028292069075966076], born=1766996695.2032907
[2025-12-29 16:25:09] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01868056841188526, 0.02628193917257358, -0.025171754207525203, 0.022679501285988054, 0.00455968985644865], born=1766996695.2032907
[2025-12-29 16:25:09] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.014622164710577307, 0.017907019645558783, -0.02110062658234637, 0.01773593364894516, 0.003601363828716682], born=1766996695.2032907
[2025-12-29 16:25:09] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:25:09] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:25:09] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2']
[2025-12-29 16:25:13] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:25:13] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:25:13] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:25:13] INFO amygdala.py:399:   conversation_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:25:13] INFO amygdala.py:400:   对话内容长度: 31 字符
[2025-12-29 16:25:13] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:25:13] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:25:13] INFO amygdala.py:107:   文本 1: The weather is beautiful today. (长度: 31 字符)
[2025-12-29 16:25:13] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:25:13] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:25:13] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:25:14] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_relationship/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:25:14] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:25:14] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:25:14] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:25:14] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:25:14] INFO amygdala.py:428:   对话ID: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:25:14] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:25:14] INFO amygdala.py:430:   关系映射详情: {'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0': 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1': 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2': 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb'}
[2025-12-29 16:25:14] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:25:14] INFO amygdala.py:442:   对话ID: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:25:14] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:25:14] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2']
[2025-12-29 16:25:14] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:25:14] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:25:14] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_persistence
[2025-12-29 16:25:15] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:25:15] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:25:15] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:25:16] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:25:16] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:25:16] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:25:16] INFO speed.py:22: Speed module initialized
[2025-12-29 16:25:16] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:25:16] INFO particle.py:79: Particle module initialized
[2025-12-29 16:25:16] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:25:16] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:25:18] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:25:18] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:25:18] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_persistence
[2025-12-29 16:25:18] INFO amygdala.py:39: Creating working directory: test_amygdala_persistence/conversation_embeddings
[2025-12-29 16:25:19] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:25:19] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:25:19] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:25:19] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:25:19] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:25:19] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:19] INFO amygdala.py:299:   输入 - conversation_text: First conversation about Python.
[2025-12-29 16:25:19] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:25:19] INFO particle.py:100: ================================================================================
[2025-12-29 16:25:19] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:25:19] INFO particle.py:102:   输入 - text_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:19] INFO particle.py:103:   输入 - text: First conversation about Python.
[2025-12-29 16:25:19] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:25:19] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:25:19] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:25:19] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:25:19] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:19] INFO emotion_v2.py:168:   输入 - text: First conversation about Python.
[2025-12-29 16:25:19] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:25:19] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:25:19] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:25:30] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:25:30] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:25:30] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python']
[2025-12-29 16:25:30] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:25:30] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:25:30] INFO emotion_v2.py:202:   实体列表: ['Python']
[2025-12-29 16:25:30] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:25:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: anticipation, curiosity, interest
[2025-12-29 16:25:32] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:25:32] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:25:32] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:25:32] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:25:33] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:33] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:25:33] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:25:33] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:25:33] INFO emotion_v2.py:277:     1. entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:25:33] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:25:33] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:25:33] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:25:33] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:25:33] INFO particle.py:119:     1. entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:25:33] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:33] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:25:33] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:25:33] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.0015426476420960502, 0.025165429055404677, -0.032756461770471965, -0.005333851799791554, -0.01350283949316505], born=1766996719.097509
[2025-12-29 16:25:33] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:25:33] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:25:33] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0']
[2025-12-29 16:25:37] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:25:37] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:25:37] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:25:37] INFO amygdala.py:399:   conversation_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:37] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:25:37] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:25:37] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:25:37] INFO amygdala.py:107:   文本 1: First conversation about Python. (长度: 32 字符)
[2025-12-29 16:25:37] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:25:37] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:25:37] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:25:38] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:25:38] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:25:38] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:38] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:25:38] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:25:38] INFO amygdala.py:428:   对话ID: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:38] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:25:38] INFO amygdala.py:430:   关系映射详情: {'test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0': 'test_conversation-31e267c3b73671aaeaf38198bf1b5afb'}
[2025-12-29 16:25:38] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:25:38] INFO amygdala.py:442:   对话ID: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:25:38] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:25:38] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0']
[2025-12-29 16:25:38] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:25:38] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:25:38] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:25:38] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:25:38] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:38] INFO amygdala.py:299:   输入 - conversation_text: Second conversation about weather.
[2025-12-29 16:25:38] INFO amygdala.py:300:   输入 - conversation_length: 34 字符
[2025-12-29 16:25:38] INFO particle.py:100: ================================================================================
[2025-12-29 16:25:38] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:25:38] INFO particle.py:102:   输入 - text_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:38] INFO particle.py:103:   输入 - text: Second conversation about weather.
[2025-12-29 16:25:38] INFO particle.py:104:   输入 - text_length: 34 字符
[2025-12-29 16:25:38] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:25:38] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:25:38] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:25:38] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:38] INFO emotion_v2.py:168:   输入 - text: Second conversation about weather.
[2025-12-29 16:25:38] INFO emotion_v2.py:169:   输入 - text_length: 34 字符
[2025-12-29 16:25:38] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:25:38] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:25:44] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:25:44] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:25:44] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather']
[2025-12-29 16:25:44] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:25:44] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:25:44] INFO emotion_v2.py:202:   实体列表: ['weather']
[2025-12-29 16:25:44] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:25:46] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: neutrality, detachment, routine
[2025-12-29 16:25:46] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:25:46] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:25:46] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:25:46] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:25:46] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:46] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:25:46] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:25:46] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:25:46] INFO emotion_v2.py:277:     1. entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:25:46] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:25:46] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:25:46] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:25:46] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:25:46] INFO particle.py:119:     1. entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:25:46] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:46] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:25:46] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:25:46] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.00593638104389047, 0.023831560176197985, -0.013740940101593263, 0.02583493319100987, 0.00028287686209144233], born=1766996738.4474335
[2025-12-29 16:25:46] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:25:46] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:25:46] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0']
[2025-12-29 16:25:48] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:25:48] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:25:48] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:25:48] INFO amygdala.py:399:   conversation_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:48] INFO amygdala.py:400:   对话内容长度: 34 字符
[2025-12-29 16:25:48] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:25:48] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:25:48] INFO amygdala.py:107:   文本 1: Second conversation about weather. (长度: 34 字符)
[2025-12-29 16:25:48] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:25:48] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:25:48] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:25:49] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:25:49] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:25:49] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:49] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:25:49] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:25:49] INFO amygdala.py:428:   对话ID: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:49] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:25:49] INFO amygdala.py:430:   关系映射详情: {'test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0': 'test_conversation-ef8e552773420d95d6d87570033f9f4a'}
[2025-12-29 16:25:49] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:25:49] INFO amygdala.py:442:   对话ID: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:25:49] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:25:49] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0']
[2025-12-29 16:25:49] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:25:49] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:25:49] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:25:49] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:25:49] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:25:49] INFO amygdala.py:299:   输入 - conversation_text: Third conversation about coding.
[2025-12-29 16:25:49] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:25:49] INFO particle.py:100: ================================================================================
[2025-12-29 16:25:49] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:25:49] INFO particle.py:102:   输入 - text_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:25:49] INFO particle.py:103:   输入 - text: Third conversation about coding.
[2025-12-29 16:25:49] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:25:49] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:25:49] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:25:49] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:25:49] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:25:49] INFO emotion_v2.py:168:   输入 - text: Third conversation about coding.
[2025-12-29 16:25:49] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:25:49] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:25:49] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:25:52] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:25:52] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:25:52] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Third conversation', 'coding']
[2025-12-29 16:25:52] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:25:52] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:25:52] INFO emotion_v2.py:202:   实体列表: ['Third conversation', 'coding']
[2025-12-29 16:25:52] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Third conversation' 生成情感描述
[2025-12-29 16:25:56] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: neutrality, curiosity, engagement, focus
[2025-12-29 16:25:56] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'coding' 生成情感描述
[2025-12-29 16:25:57] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: hope, frustration, persistence, anticipation
[2025-12-29 16:25:57] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:25:57] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:25:57] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:25:57] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:25:58] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:59] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:25:59] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:25:59] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:25:59] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:25:59] INFO emotion_v2.py:277:     1. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, vector_shape=(2048,)
[2025-12-29 16:25:59] INFO emotion_v2.py:277:     2. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, vector_shape=(2048,)
[2025-12-29 16:25:59] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:25:59] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:25:59] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:25:59] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:25:59] INFO particle.py:119:     1. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, vector_shape=(2048,)
[2025-12-29 16:25:59] INFO particle.py:119:     2. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, vector_shape=(2048,)
[2025-12-29 16:25:59] INFO particle.py:201: Successfully created 2 particles for text_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:25:59] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:25:59] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:25:59] INFO amygdala.py:316:   粒子 1/2: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.006055811842162237, 0.041719111912639384, -0.009799085744598113, 0.01541691659817582, -0.016654941565908122], born=1766996749.212578
[2025-12-29 16:25:59] INFO amygdala.py:316:   粒子 2/2: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.002866186367614819, 0.01050476438130615, -0.04600573248017896, 0.034045706615315884, -0.016729356810974174], born=1766996749.212578
[2025-12-29 16:25:59] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:25:59] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:25:59] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0', 'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1']
[2025-12-29 16:26:00] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:26:00] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:26:00] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:26:00] INFO amygdala.py:399:   conversation_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:26:00] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:26:00] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:26:00] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:26:00] INFO amygdala.py:107:   文本 1: Third conversation about coding. (长度: 32 字符)
[2025-12-29 16:26:00] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:26:00] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:26:00] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:26:01] INFO amygdala.py:95: Saved 3 conversation records to test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:26:01] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 3
[2025-12-29 16:26:01] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:26:01] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:26:01] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:26:01] INFO amygdala.py:428:   对话ID: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:26:01] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:26:01] INFO amygdala.py:430:   关系映射详情: {'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0': 'test_conversation-f58a5e81158d014f5afd4dc620281fed', 'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1': 'test_conversation-f58a5e81158d014f5afd4dc620281fed'}
[2025-12-29 16:26:01] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:26:01] INFO amygdala.py:442:   对话ID: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:26:01] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:26:01] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0', 'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1']
[2025-12-29 16:26:01] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:26:01] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:26:01] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:26:01] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:01] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:26:01] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:26:01] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:01] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:26:01] INFO speed.py:22: Speed module initialized
[2025-12-29 16:26:01] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:26:01] INFO particle.py:79: Particle module initialized
[2025-12-29 16:26:01] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:26:02] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:26:02] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:26:02] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_persistence
[2025-12-29 16:26:02] INFO amygdala.py:70: Loaded 3 conversation records from test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:26:02] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:26:02] INFO amygdala.py:502: Loaded 4 relationship mappings for 3 conversations
[2025-12-29 16:26:02] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:26:02] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:26:02] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:26:02] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:26:02] INFO amygdala.py:299:   输入 - conversation_text: New conversation added after reload.
[2025-12-29 16:26:02] INFO amygdala.py:300:   输入 - conversation_length: 36 字符
[2025-12-29 16:26:02] INFO particle.py:100: ================================================================================
[2025-12-29 16:26:02] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:26:02] INFO particle.py:102:   输入 - text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:26:02] INFO particle.py:103:   输入 - text: New conversation added after reload.
[2025-12-29 16:26:02] INFO particle.py:104:   输入 - text_length: 36 字符
[2025-12-29 16:26:02] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:02] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:26:02] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:26:02] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:26:02] INFO emotion_v2.py:168:   输入 - text: New conversation added after reload.
[2025-12-29 16:26:02] INFO emotion_v2.py:169:   输入 - text_length: 36 字符
[2025-12-29 16:26:02] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:02] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:26:18] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:26:18] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 0
[2025-12-29 16:26:18] INFO emotion_v2.py:178:   抽取结果 - 实体列表: []
[2025-12-29 16:26:18] WARNING emotion_v2.py:180: [EmotionV2.process] 警告: 未从文本中提取到任何实体
[2025-12-29 16:26:18] WARNING emotion_v2.py:181:   文本内容: New conversation added after reload.
[2025-12-29 16:26:18] WARNING emotion_v2.py:182:   可能原因: 1) 文本中确实没有命名实体 2) 实体提取器无法识别该类型的实体
[2025-12-29 16:26:18] WARNING emotion_v2.py:193: [EmotionV2.process] 处理终止: 没有实体可处理
[2025-12-29 16:26:18] WARNING emotion_v2.py:194:   text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:26:18] WARNING emotion_v2.py:195:   文本内容: New conversation added after reload.
[2025-12-29 16:26:18] WARNING emotion_v2.py:196: ================================================================================
[2025-12-29 16:26:18] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:26:18] INFO particle.py:115:   提取结果 - emotion_nodes数量: 0
[2025-12-29 16:26:18] WARNING particle.py:134: [Particle.process] 处理终止: 没有情绪节点
[2025-12-29 16:26:18] WARNING particle.py:135:   text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:26:18] WARNING particle.py:136:   文本内容: New conversation added after reload.
[2025-12-29 16:26:18] WARNING particle.py:137:   可能原因: 1) 未提取到实体 2) 情感描述生成失败 3) 情绪嵌入失败
[2025-12-29 16:26:18] WARNING particle.py:138: ================================================================================
[2025-12-29 16:26:18] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 0 个粒子
[2025-12-29 16:26:18] WARNING amygdala.py:328: [Amygdala.add] 警告: 对话 'New conversation added after reload....' 未生成任何粒子
[2025-12-29 16:26:18] WARNING amygdala.py:329:   可能原因: 1) 文本中未提取到实体 2) 实体提取失败 3) 情绪分析失败
[2025-12-29 16:26:18] WARNING amygdala.py:340: [Amygdala.add] 处理完成，但未生成粒子
[2025-12-29 16:26:18] WARNING amygdala.py:341:   对话ID: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:26:18] WARNING amygdala.py:342:   对话内容: New conversation added after reload.
[2025-12-29 16:26:18] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:26:18] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:18] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:26:18] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:26:18] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:18] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:26:18] INFO speed.py:22: Speed module initialized
[2025-12-29 16:26:18] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:26:18] INFO particle.py:79: Particle module initialized
[2025-12-29 16:26:18] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:26:18] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:26:18] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:26:18] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_persistence
[2025-12-29 16:26:19] INFO amygdala.py:70: Loaded 3 conversation records from test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:26:19] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:26:19] INFO amygdala.py:502: Loaded 4 relationship mappings for 3 conversations
[2025-12-29 16:26:19] INFO amygdala.py:259: Amygdala workflow initialized
Traceback (most recent call last):
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 390, in test_amygdala_persistence
    assert len(new_particles) > 0, "新对话的粒子应该已保存"
AssertionError: 新对话的粒子应该已保存
[2025-12-29 16:26:19] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_custom_id
[2025-12-29 16:26:19] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:26:20] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:20] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:26:20] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:26:20] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:20] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:26:20] INFO speed.py:22: Speed module initialized
[2025-12-29 16:26:20] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:26:20] INFO particle.py:79: Particle module initialized
[2025-12-29 16:26:20] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:26:20] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:26:21] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_custom_id, collection=test_particles_custom_id
[2025-12-29 16:26:21] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_custom_id, collection=test_particles_custom_id
[2025-12-29 16:26:21] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_custom_id
[2025-12-29 16:26:21] INFO amygdala.py:39: Creating working directory: test_amygdala_custom_id/conversation_embeddings
[2025-12-29 16:26:21] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:26:21] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:26:21] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:26:21] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:26:21] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:26:21] INFO amygdala.py:298:   输入 - conversation_id: custom_conversation_001
[2025-12-29 16:26:21] INFO amygdala.py:299:   输入 - conversation_text: This is a test conversation.
[2025-12-29 16:26:21] INFO amygdala.py:300:   输入 - conversation_length: 28 字符
[2025-12-29 16:26:21] INFO particle.py:100: ================================================================================
[2025-12-29 16:26:21] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:26:21] INFO particle.py:102:   输入 - text_id: custom_conversation_001
[2025-12-29 16:26:21] INFO particle.py:103:   输入 - text: This is a test conversation.
[2025-12-29 16:26:21] INFO particle.py:104:   输入 - text_length: 28 字符
[2025-12-29 16:26:21] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:21] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:26:21] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:26:21] INFO emotion_v2.py:167:   输入 - text_id: custom_conversation_001
[2025-12-29 16:26:21] INFO emotion_v2.py:168:   输入 - text: This is a test conversation.
[2025-12-29 16:26:21] INFO emotion_v2.py:169:   输入 - text_length: 28 字符
[2025-12-29 16:26:21] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:21] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:26:23] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:26:23] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:26:23] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['test', 'conversation']
[2025-12-29 16:26:23] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:26:23] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:26:23] INFO emotion_v2.py:202:   实体列表: ['test', 'conversation']
[2025-12-29 16:26:23] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'test' 生成情感描述
[2025-12-29 16:26:24] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: neutrality, focus, curiosity
[2025-12-29 16:26:24] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:26:26] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: neutrality, detachment
[2025-12-29 16:26:26] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:26:26] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:26:26] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:26:26] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:26:27] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=custom_conversation_001_entity_0, entity=test, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:26:27] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=custom_conversation_001_entity_1, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:26:27] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:26:27] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:26:27] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:26:27] INFO emotion_v2.py:277:     1. entity_id=custom_conversation_001_entity_0, entity=test, vector_shape=(2048,)
[2025-12-29 16:26:27] INFO emotion_v2.py:277:     2. entity_id=custom_conversation_001_entity_1, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:26:27] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:26:27] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:26:27] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:26:27] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:26:27] INFO particle.py:119:     1. entity_id=custom_conversation_001_entity_0, entity=test, vector_shape=(2048,)
[2025-12-29 16:26:27] INFO particle.py:119:     2. entity_id=custom_conversation_001_entity_1, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:26:27] INFO particle.py:201: Successfully created 2 particles for text_id: custom_conversation_001
[2025-12-29 16:26:27] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:26:27] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:26:27] INFO amygdala.py:316:   粒子 1/2: entity_id=custom_conversation_001_entity_0, entity=test, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.004578639457529923, 0.04437032152657866, -0.012178237418997128, 0.013098684450665476, -0.010626455365607447], born=1766996781.1054742
[2025-12-29 16:26:27] INFO amygdala.py:316:   粒子 2/2: entity_id=custom_conversation_001_entity_1, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.013701556075091742, 0.01488830508159575, -0.013437834073646406, 0.025581032140197527, -0.011435945062675], born=1766996781.1054742
[2025-12-29 16:26:27] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:26:27] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:26:27] INFO amygdala.py:380:   粒子ID列表: ['custom_conversation_001_entity_0', 'custom_conversation_001_entity_1']
[2025-12-29 16:26:29] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:26:29] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:26:29] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:26:29] INFO amygdala.py:399:   conversation_id: custom_conversation_001
[2025-12-29 16:26:29] INFO amygdala.py:400:   对话内容长度: 28 字符
[2025-12-29 16:26:29] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:26:29] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:26:29] INFO amygdala.py:107:   文本 1: This is a test conversation. (长度: 28 字符)
[2025-12-29 16:26:29] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:26:29] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:26:29] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:26:29] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_custom_id/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:26:29] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:26:29] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=custom_conversation_001
[2025-12-29 16:26:29] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:26:29] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:26:29] INFO amygdala.py:428:   对话ID: custom_conversation_001
[2025-12-29 16:26:29] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:26:29] INFO amygdala.py:430:   关系映射详情: {'custom_conversation_001_entity_0': 'custom_conversation_001', 'custom_conversation_001_entity_1': 'custom_conversation_001'}
[2025-12-29 16:26:29] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:26:29] INFO amygdala.py:442:   对话ID: custom_conversation_001
[2025-12-29 16:26:29] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:26:29] INFO amygdala.py:444:   粒子ID列表: ['custom_conversation_001_entity_0', 'custom_conversation_001_entity_1']
[2025-12-29 16:26:29] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:26:29] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:26:29] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_linking
[2025-12-29 16:26:30] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:26:30] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:30] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:26:30] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:26:30] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:30] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:26:30] INFO speed.py:22: Speed module initialized
[2025-12-29 16:26:30] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:26:30] INFO particle.py:79: Particle module initialized
[2025-12-29 16:26:30] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:26:30] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:26:31] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_linking, collection=test_particles_linking
[2025-12-29 16:26:31] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_linking, collection=test_particles_linking
[2025-12-29 16:26:31] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_linking
[2025-12-29 16:26:31] INFO amygdala.py:39: Creating working directory: test_amygdala_linking/conversation_embeddings
[2025-12-29 16:26:31] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:26:31] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:26:31] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:26:31] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:26:31] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:26:31] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:31] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming and machine learning!
[2025-12-29 16:26:31] INFO amygdala.py:300:   输入 - conversation_length: 47 字符
[2025-12-29 16:26:31] INFO particle.py:100: ================================================================================
[2025-12-29 16:26:31] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:26:31] INFO particle.py:102:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:31] INFO particle.py:103:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:26:31] INFO particle.py:104:   输入 - text_length: 47 字符
[2025-12-29 16:26:31] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:31] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:26:31] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:26:31] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:31] INFO emotion_v2.py:168:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:26:31] INFO emotion_v2.py:169:   输入 - text_length: 47 字符
[2025-12-29 16:26:31] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:31] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:26:31] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:26:31] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:26:31] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:26:31] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:26:31] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:26:31] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:26:31] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:26:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, enthusiasm, interest
[2025-12-29 16:26:32] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:26:34] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, enthusiasm, passion
[2025-12-29 16:26:34] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'machine learning' 生成情感描述
[2025-12-29 16:26:35] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, enthusiasm, excitement
[2025-12-29 16:26:35] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:26:35] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:26:35] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:26:35] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:26:36] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:26:36] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:26:37] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:26:37] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:26:37] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:26:37] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:26:37] INFO emotion_v2.py:277:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:26:37] INFO emotion_v2.py:277:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:26:37] INFO emotion_v2.py:277:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:26:37] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:26:37] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:26:37] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:26:37] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:26:37] INFO particle.py:119:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:26:37] INFO particle.py:119:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:26:37] INFO particle.py:119:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:26:37] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:37] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:26:37] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:26:37] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016755870381375472, 0.01363772549649697, -0.029872056897127595, -0.0031985960819082538, -0.004668895827624981], born=1766996791.1300275
[2025-12-29 16:26:37] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.014658516539968048, 0.014200438554344027, -0.03615469386534805, 0.012837375097121394, -0.008139275744563041], born=1766996791.1300275
[2025-12-29 16:26:37] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01817879490415652, 0.014275440924736047, -0.029236455845857566, 0.007242767961814185, -0.011201410940943157], born=1766996791.1300275
[2025-12-29 16:26:37] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:26:37] INFO amygdala.py:355:   参数: distance_threshold=1.5, top_k=5
[2025-12-29 16:26:37] INFO linking.py:72: Building hyperbolic links for 3 entities (threshold=1.5, top_k=5)
[2025-12-29 16:26:37] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:26:37] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:26:37] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:26:37] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:26:37] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:26:41] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:26:41] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:26:41] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:26:41] INFO amygdala.py:399:   conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:41] INFO amygdala.py:400:   对话内容长度: 47 字符
[2025-12-29 16:26:41] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:26:41] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:26:41] INFO amygdala.py:107:   文本 1: I love Python programming and machine learning! (长度: 47 字符)
[2025-12-29 16:26:41] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:26:41] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:26:41] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:26:41] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_linking/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:26:41] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:26:41] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:41] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:26:41] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:26:41] INFO amygdala.py:428:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:41] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:26:41] INFO amygdala.py:430:   关系映射详情: {'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e'}
[2025-12-29 16:26:42] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:26:42] INFO amygdala.py:442:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:26:42] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:26:42] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:26:42] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:26:42] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:26:42] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_edge
[2025-12-29 16:26:42] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:26:42] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:43] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:26:43] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:26:43] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:26:43] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:26:43] INFO speed.py:22: Speed module initialized
[2025-12-29 16:26:43] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:26:43] INFO particle.py:79: Particle module initialized
[2025-12-29 16:26:43] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:26:43] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:26:44] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_edge, collection=test_particles_edge
[2025-12-29 16:26:44] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_edge, collection=test_particles_edge
[2025-12-29 16:26:44] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_edge
[2025-12-29 16:26:44] INFO amygdala.py:39: Creating working directory: test_amygdala_edge/conversation_embeddings
[2025-12-29 16:26:44] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:26:44] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:26:44] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:26:44] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:26:44] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:26:44] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:26:44] INFO amygdala.py:299:   输入 - conversation_text: 
[2025-12-29 16:26:44] INFO amygdala.py:300:   输入 - conversation_length: 0 字符
[2025-12-29 16:26:44] INFO particle.py:100: ================================================================================
[2025-12-29 16:26:44] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:26:44] INFO particle.py:102:   输入 - text_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:26:44] INFO particle.py:103:   输入 - text: 
[2025-12-29 16:26:44] INFO particle.py:104:   输入 - text_length: 0 字符
[2025-12-29 16:26:44] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:44] WARNING emotion_v2.py:157: ================================================================================
[2025-12-29 16:26:44] WARNING emotion_v2.py:158: [EmotionV2.process] 输入文本为空，跳过处理
[2025-12-29 16:26:44] WARNING emotion_v2.py:159:   text_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:26:44] WARNING emotion_v2.py:160:   text_length: 0 字符
[2025-12-29 16:26:44] WARNING emotion_v2.py:161: ================================================================================
[2025-12-29 16:26:44] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:26:44] INFO particle.py:115:   提取结果 - emotion_nodes数量: 0
[2025-12-29 16:26:44] WARNING particle.py:134: [Particle.process] 处理终止: 没有情绪节点
[2025-12-29 16:26:44] WARNING particle.py:135:   text_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:26:44] WARNING particle.py:136:   文本内容: 
[2025-12-29 16:26:44] WARNING particle.py:137:   可能原因: 1) 未提取到实体 2) 情感描述生成失败 3) 情绪嵌入失败
[2025-12-29 16:26:44] WARNING particle.py:138: ================================================================================
[2025-12-29 16:26:44] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 0 个粒子
[2025-12-29 16:26:44] WARNING amygdala.py:328: [Amygdala.add] 警告: 对话 '...' 未生成任何粒子
[2025-12-29 16:26:44] WARNING amygdala.py:329:   可能原因: 1) 文本中未提取到实体 2) 实体提取失败 3) 情绪分析失败
[2025-12-29 16:26:44] WARNING amygdala.py:340: [Amygdala.add] 处理完成，但未生成粒子
[2025-12-29 16:26:44] WARNING amygdala.py:341:   对话ID: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:26:44] WARNING amygdala.py:342:   对话内容: 
[2025-12-29 16:26:44] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:26:44] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:26:44] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:44] INFO amygdala.py:299:   输入 - conversation_text: This is a repeated conversation.
[2025-12-29 16:26:44] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:26:44] INFO particle.py:100: ================================================================================
[2025-12-29 16:26:44] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:26:44] INFO particle.py:102:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:44] INFO particle.py:103:   输入 - text: This is a repeated conversation.
[2025-12-29 16:26:44] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:26:44] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:44] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:26:44] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:26:44] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:44] INFO emotion_v2.py:168:   输入 - text: This is a repeated conversation.
[2025-12-29 16:26:44] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:26:44] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:44] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:26:47] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:26:47] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:26:47] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['conversation']
[2025-12-29 16:26:47] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:26:47] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:26:47] INFO emotion_v2.py:202:   实体列表: ['conversation']
[2025-12-29 16:26:47] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:26:48] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, weariness, boredom, annoyance
[2025-12-29 16:26:48] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:26:48] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:26:48] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:26:48] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:26:49] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:26:49] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:26:49] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:26:49] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:26:49] INFO emotion_v2.py:277:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:26:49] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:26:49] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:26:49] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:26:49] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:26:49] INFO particle.py:119:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:26:49] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:49] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:26:49] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:26:49] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.010392700872332274, 0.01966249975845868, -0.03083304262123566, 0.03712597954393093, -0.0035529349563544516], born=1766996804.375999
[2025-12-29 16:26:49] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:26:49] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:26:49] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:26:54] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:26:54] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:26:54] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:26:54] INFO amygdala.py:399:   conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:54] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:26:54] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:26:54] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:26:54] INFO amygdala.py:107:   文本 1: This is a repeated conversation. (长度: 32 字符)
[2025-12-29 16:26:54] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:26:54] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:26:54] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:26:55] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_edge/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:26:55] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:26:55] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:55] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:26:55] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:26:55] INFO amygdala.py:428:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:55] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:26:55] INFO amygdala.py:430:   关系映射详情: {'test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0': 'test_conversation-67761e24aa41439e9fd7a98cf1968b90'}
[2025-12-29 16:26:56] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:26:56] INFO amygdala.py:442:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:56] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:26:56] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:26:56] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:26:56] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:26:56] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:26:56] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:26:56] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:56] INFO amygdala.py:299:   输入 - conversation_text: This is a repeated conversation.
[2025-12-29 16:26:56] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:26:56] INFO particle.py:100: ================================================================================
[2025-12-29 16:26:56] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:26:56] INFO particle.py:102:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:56] INFO particle.py:103:   输入 - text: This is a repeated conversation.
[2025-12-29 16:26:56] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:26:56] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:56] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:26:56] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:26:56] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:26:56] INFO emotion_v2.py:168:   输入 - text: This is a repeated conversation.
[2025-12-29 16:26:56] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:26:56] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:26:56] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:26:57] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:26:57] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:26:57] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['conversation']
[2025-12-29 16:26:57] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:26:57] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:26:57] INFO emotion_v2.py:202:   实体列表: ['conversation']
[2025-12-29 16:26:57] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:27:01] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, weariness, disappointment
[2025-12-29 16:27:01] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:27:01] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:27:01] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:27:01] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:27:02] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:02] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:27:02] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:27:02] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:27:02] INFO emotion_v2.py:277:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:27:02] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:27:02] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:27:02] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:27:02] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:27:02] INFO particle.py:119:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:27:02] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:27:02] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:27:02] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:27:02] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.008964752904944119, 0.02225900376398131, -0.03889210458761571, 0.03678850960992074, -0.015410079836602444], born=1766996816.0482023
[2025-12-29 16:27:02] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:27:02] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:27:02] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:27:05] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:27:05] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:27:05] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:27:05] INFO amygdala.py:399:   conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:27:05] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:27:05] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:27:05] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:27:05] INFO amygdala.py:107:   文本 1: This is a repeated conversation. (长度: 32 字符)
[2025-12-29 16:27:05] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 0 条新记录, 1 条已存在
[2025-12-29 16:27:05] INFO amygdala.py:131: [SimpleConversationStore.insert_strings] 所有文本已存在，跳过插入
[2025-12-29 16:27:05] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:27:05] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:27:05] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:27:05] INFO amygdala.py:428:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:27:05] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:27:05] INFO amygdala.py:430:   关系映射详情: {'test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0': 'test_conversation-67761e24aa41439e9fd7a98cf1968b90'}
[2025-12-29 16:27:05] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:27:05] INFO amygdala.py:442:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:27:05] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:27:05] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:27:05] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:27:05] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:27:05] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:27:05] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:27:05] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:05] INFO amygdala.py:299:   输入 - conversation_text: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:27:05] INFO amygdala.py:300:   输入 - conversation_length: 44 字符
[2025-12-29 16:27:05] INFO particle.py:100: ================================================================================
[2025-12-29 16:27:05] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:27:05] INFO particle.py:102:   输入 - text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:05] INFO particle.py:103:   输入 - text: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:27:05] INFO particle.py:104:   输入 - text_length: 44 字符
[2025-12-29 16:27:05] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:05] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:27:05] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:27:05] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:05] INFO emotion_v2.py:168:   输入 - text: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:27:05] INFO emotion_v2.py:169:   输入 - text_length: 44 字符
[2025-12-29 16:27:05] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:05] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:27:10] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:27:10] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 0
[2025-12-29 16:27:10] INFO emotion_v2.py:178:   抽取结果 - 实体列表: []
[2025-12-29 16:27:10] WARNING emotion_v2.py:180: [EmotionV2.process] 警告: 未从文本中提取到任何实体
[2025-12-29 16:27:10] WARNING emotion_v2.py:181:   文本内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:27:10] WARNING emotion_v2.py:182:   可能原因: 1) 文本中确实没有命名实体 2) 实体提取器无法识别该类型的实体
[2025-12-29 16:27:10] WARNING emotion_v2.py:193: [EmotionV2.process] 处理终止: 没有实体可处理
[2025-12-29 16:27:10] WARNING emotion_v2.py:194:   text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:10] WARNING emotion_v2.py:195:   文本内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:27:10] WARNING emotion_v2.py:196: ================================================================================
[2025-12-29 16:27:10] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:27:10] INFO particle.py:115:   提取结果 - emotion_nodes数量: 0
[2025-12-29 16:27:10] WARNING particle.py:134: [Particle.process] 处理终止: 没有情绪节点
[2025-12-29 16:27:10] WARNING particle.py:135:   text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:10] WARNING particle.py:136:   文本内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:27:10] WARNING particle.py:137:   可能原因: 1) 未提取到实体 2) 情感描述生成失败 3) 情绪嵌入失败
[2025-12-29 16:27:10] WARNING particle.py:138: ================================================================================
[2025-12-29 16:27:10] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 0 个粒子
[2025-12-29 16:27:10] WARNING amygdala.py:328: [Amygdala.add] 警告: 对话 'Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?...' 未生成任何粒子
[2025-12-29 16:27:10] WARNING amygdala.py:329:   可能原因: 1) 文本中未提取到实体 2) 实体提取失败 3) 情绪分析失败
[2025-12-29 16:27:10] WARNING amygdala.py:340: [Amygdala.add] 处理完成，但未生成粒子
[2025-12-29 16:27:10] WARNING amygdala.py:341:   对话ID: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:10] WARNING amygdala.py:342:   对话内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?

====================================================================================================
Amygdala 工作流类 - 全方位测试
====================================================================================================
====================================================================================================
测试1：基本功能测试
====================================================================================================

【Step 1】初始化 Amygdala...
✓ Amygdala 初始化成功
  - 工作目录: ./test_amygdala_basic
  - 粒子集合: test_particles_basic
  - 对话命名空间: test_conversation

【Step 2】添加对话...
对话内容: I love Python programming and I'm excited about machine learning!

✓ 对话处理成功
  - 对话 ID: test_conversation-a303c4404f2ed0d8ad548c735f18a136
  - 生成粒子数: 3
  - 关系映射数: 3

【Step 3】验证粒子信息...
✓ 成功生成 3 个粒子:
  1. test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0: Python
     速度: 0.5000, 温度: 0.5000, 质量: 1.0000
  2. test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1: programming
     速度: 0.5000, 温度: 0.5000, 质量: 1.0000
  3. test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2: machine learning
     速度: 0.5000, 温度: 0.5000, 质量: 1.0000

【Step 4】验证关系映射...
✓ 关系映射包含 3 条记录
  test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0 -> test_conversation-a303c4404f2ed0d8ad548c735f18a136
  test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1 -> test_conversation-a303c4404f2ed0d8ad548c735f18a136
  test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2 -> test_conversation-a303c4404f2ed0d8ad548c735f18a136

====================================================================================================
✓ 测试1完成：基本功能正常
====================================================================================================

✓ 基本功能 测试通过

====================================================================================================
测试2：多个对话测试
====================================================================================================

【Step 1】初始化 Amygdala...
✓ 初始化成功

【Step 2】添加多个对话...

添加对话 1: I love Python programming and machine learning!...
  ✓ 对话 ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
  ✓ 生成粒子数: 3

添加对话 2: The weather is beautiful today, I feel happy....
  ✓ 对话 ID: test_conversation-83524becd2b7394577cc4ea2e2f8d724
  ✓ 生成粒子数: 3

添加对话 3: I'm frustrated with this bug in my code....
  ✓ 对话 ID: test_conversation-028403027411873a0426c8a1906d39af
  ✓ 生成粒子数: 3

添加对话 4: Learning new technologies is exciting and challeng...
  ✓ 对话 ID: test_conversation-e05db879cb2c698162903b78288164db
  ✓ 生成粒子数: 4

【Step 3】验证所有对话处理结果...
✓ 总共处理了 4 个对话
✓ 总共生成了 13 个粒子

【Step 4】验证关系映射...
✓ 验证了 13 个粒子的映射关系
✓ 涉及 4 个对话

【Step 5】验证反向映射...
  对话 test_conversation-02... 包含 3 个粒子
  对话 test_conversation-83... 包含 3 个粒子
  对话 test_conversation-d9... 包含 3 个粒子
  对话 test_conversation-e0... 包含 4 个粒子

====================================================================================================
✓ 测试2完成：多个对话处理正常
====================================================================================================

✓ 多个对话 测试通过

====================================================================================================
测试3：关系映射功能测试
====================================================================================================

【Step 1】初始化并添加对话...
✓ 添加了 2 个对话
  对话1 ID: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
  对话2 ID: test_conversation-042bc3ca359baf149ebbe296e0f5adfb

【Step 2】测试 get_conversation_by_particle...
  粒子 test_conversation-5e... -> 对话 test_conversation-5e...
  ✓ 映射关系正确

【Step 3】测试 get_particles_by_conversation...
  对话1包含 2 个粒子
  对话2包含 3 个粒子
  ✓ 粒子列表正确

【Step 4】测试 get_conversation_text...
  对话1文本: I love Python programming!...
  ✓ 对话文本正确
  对话2文本: The weather is beautiful today....
  ✓ 对话文本正确

【Step 5】测试边界情况...
  ✓ 不存在的粒子返回 None
  ✓ 不存在的对话返回空列表

====================================================================================================
✓ 测试3完成：关系映射功能正常
====================================================================================================

✓ 关系映射 测试通过

====================================================================================================
测试4：持久化测试
====================================================================================================

【Step 1】创建第一个 Amygdala 实例并添加数据...
✓ 添加了 3 个对话
✓ 生成了 4 个粒子
✓ 记录了 4 条映射关系

【Step 2】创建第二个 Amygdala 实例（加载已有数据）...

【Step 3】验证数据已加载...
  加载的映射关系数: 4
  原始映射关系数: 4
  ✓ 所有映射关系一致

【Step 4】添加新对话并验证持久化...

❌ 测试4失败: 新对话的粒子应该已保存

❌ 持久化 测试失败: 新对话的粒子应该已保存

====================================================================================================
测试5：自定义对话 ID 测试
====================================================================================================

【Step 1】初始化 Amygdala...

【Step 2】使用自定义 ID 添加对话...
  提供的 ID: custom_conversation_001
  返回的 ID: custom_conversation_001
  ✓ 自定义 ID 正确使用

【Step 3】验证自定义 ID 查询...
  查询到的粒子数: 2
  查询到的文本: None...
  ✓ 自定义 ID 查询正常

====================================================================================================
✓ 测试5完成：自定义对话 ID 功能正常
====================================================================================================

✓ 自定义ID 测试通过

====================================================================================================
测试6：自动链接功能测试
====================================================================================================

【Step 1】初始化 Amygdala（启用自动链接）...
✓ 初始化成功，自动链接已启用

【Step 2】添加对话...
✓ 添加了对话，生成了 3 个粒子

【Step 3】验证粒子链接...
  ✓ 生成了 3 个粒子，链接应该已构建
  （链接信息存储在粒子的 metadata 中）

====================================================================================================
✓ 测试6完成：自动链接功能正常
====================================================================================================

✓ 自动链接 测试通过

====================================================================================================
测试7：边界情况测试
====================================================================================================

【Step 1】初始化 Amygdala...

【Step 2】测试空对话...
  空对话结果: 0 个粒子
  ✓ 空对话处理正确

【Step 3】测试重复对话...
  第一次添加: test_conversation-67761e24aa41439e9fd7a98cf1968b90
  第二次添加: test_conversation-67761e24aa41439e9fd7a98cf1968b90
  ✓ 重复对话处理正确（生成相同 ID）

【Step 4】测试特殊字符...
  ✓ 特殊字符对话处理成功: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:27:10] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:27:10] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:27:10] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:10] INFO amygdala.py:299:   输入 - conversation_text: This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversati...
[2025-12-29 16:27:10] INFO amygdala.py:300:   输入 - conversation_length: 3400 字符
[2025-12-29 16:27:10] INFO particle.py:100: ================================================================================
[2025-12-29 16:27:10] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:27:10] INFO particle.py:102:   输入 - text_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:10] INFO particle.py:103:   输入 - text: This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversati...
[2025-12-29 16:27:10] INFO particle.py:104:   输入 - text_length: 3400 字符
[2025-12-29 16:27:10] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:10] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:27:10] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:27:10] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:10] INFO emotion_v2.py:168:   输入 - text: This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversati...
[2025-12-29 16:27:10] INFO emotion_v2.py:169:   输入 - text_length: 3400 字符
[2025-12-29 16:27:10] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:10] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:27:16] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:27:16] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:27:16] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['conversation']
[2025-12-29 16:27:16] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:27:16] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:27:16] INFO emotion_v2.py:202:   实体列表: ['conversation']
[2025-12-29 16:27:16] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:27:23] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: tedium, frustration, weariness, impatience
[2025-12-29 16:27:23] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:27:23] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:27:23] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:27:23] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:27:23] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:23] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:27:23] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:27:23] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:27:23] INFO emotion_v2.py:277:     1. entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:27:23] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:27:23] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:27:23] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:27:23] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:27:23] INFO particle.py:119:     1. entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:27:23] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:23] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:27:23] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:27:23] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0002095572269955952, 0.025334452636782027, -0.02129322969472071, 0.023585619661854903, -0.006918526900809646], born=1766996830.6258585
[2025-12-29 16:27:23] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:27:23] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:27:23] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0']
[2025-12-29 16:27:24] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:27:24] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:27:24] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:27:24] INFO amygdala.py:399:   conversation_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:24] INFO amygdala.py:400:   对话内容长度: 3400 字符
[2025-12-29 16:27:24] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:27:24] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:27:24] INFO amygdala.py:107:   文本 1: This is a very long conversation. This is a very long conversation. This is a very long conversation... (长度: 3400 字符)
[2025-12-29 16:27:24] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:27:24] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:27:24] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:27:24] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_edge/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:27:24] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:27:24] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:24] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:27:24] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:27:24] INFO amygdala.py:428:   对话ID: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:24] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:27:24] INFO amygdala.py:430:   关系映射详情: {'test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0': 'test_conversation-c71799e88f5e10295ff92584914c2d52'}
[2025-12-29 16:27:24] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:27:24] INFO amygdala.py:442:   对话ID: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:27:24] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:27:24] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0']
[2025-12-29 16:27:24] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:27:24] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:27:24] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_integration
[2025-12-29 16:27:25] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:27:25] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:27:25] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:27:26] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:27:26] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:27:26] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:27:26] INFO speed.py:22: Speed module initialized
[2025-12-29 16:27:26] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:27:26] INFO particle.py:79: Particle module initialized
[2025-12-29 16:27:26] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:27:26] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:27:28] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_integration, collection=test_particles_integration
[2025-12-29 16:27:28] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_integration, collection=test_particles_integration
[2025-12-29 16:27:28] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_integration
[2025-12-29 16:27:28] INFO amygdala.py:39: Creating working directory: test_amygdala_integration/conversation_embeddings
[2025-12-29 16:27:29] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:27:29] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:27:29] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:27:29] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:27:29] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:27:29] INFO amygdala.py:298:   输入 - conversation_id: conv_001
[2025-12-29 16:27:29] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming!
[2025-12-29 16:27:29] INFO amygdala.py:300:   输入 - conversation_length: 26 字符
[2025-12-29 16:27:29] INFO particle.py:100: ================================================================================
[2025-12-29 16:27:29] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:27:29] INFO particle.py:102:   输入 - text_id: conv_001
[2025-12-29 16:27:29] INFO particle.py:103:   输入 - text: I love Python programming!
[2025-12-29 16:27:29] INFO particle.py:104:   输入 - text_length: 26 字符
[2025-12-29 16:27:29] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:29] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:27:29] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:27:29] INFO emotion_v2.py:167:   输入 - text_id: conv_001
[2025-12-29 16:27:29] INFO emotion_v2.py:168:   输入 - text: I love Python programming!
[2025-12-29 16:27:29] INFO emotion_v2.py:169:   输入 - text_length: 26 字符
[2025-12-29 16:27:29] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:29] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:27:29] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:27:29] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:27:29] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming']
[2025-12-29 16:27:29] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:27:29] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:27:29] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming']
[2025-12-29 16:27:29] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:27:31] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, enthusiasm
[2025-12-29 16:27:31] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:27:37] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, love, enthusiasm, admiration, pride, satisfaction
[2025-12-29 16:27:37] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:27:37] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:27:37] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:27:37] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:27:38] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_001_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:38] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_001_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:38] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:27:38] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:27:38] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:27:38] INFO emotion_v2.py:277:     1. entity_id=conv_001_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:27:38] INFO emotion_v2.py:277:     2. entity_id=conv_001_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:27:38] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:27:38] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:27:38] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:27:38] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:27:38] INFO particle.py:119:     1. entity_id=conv_001_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:27:38] INFO particle.py:119:     2. entity_id=conv_001_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:27:38] INFO particle.py:201: Successfully created 2 particles for text_id: conv_001
[2025-12-29 16:27:38] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:27:38] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:27:38] INFO amygdala.py:316:   粒子 1/2: entity_id=conv_001_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016803517936497536, 0.01231359995346546, -0.031923315879358045, 0.007413976971981712, -0.010472733460422311], born=1766996849.1063843
[2025-12-29 16:27:38] INFO amygdala.py:316:   粒子 2/2: entity_id=conv_001_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.019132592642594176, 0.012847920431514902, -0.03394168713997778, 0.017227132578596704, -0.0016227046545007455], born=1766996849.1063843
[2025-12-29 16:27:38] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:27:38] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:27:38] INFO linking.py:72: Building hyperbolic links for 2 entities (threshold=2.0, top_k=10)
[2025-12-29 16:27:38] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:27:38] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:27:38] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:27:38] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:27:38] INFO amygdala.py:380:   粒子ID列表: ['conv_001_entity_0', 'conv_001_entity_1']
[2025-12-29 16:27:45] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:27:45] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:27:45] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:27:45] INFO amygdala.py:399:   conversation_id: conv_001
[2025-12-29 16:27:45] INFO amygdala.py:400:   对话内容长度: 26 字符
[2025-12-29 16:27:45] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:27:45] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:27:45] INFO amygdala.py:107:   文本 1: I love Python programming! (长度: 26 字符)
[2025-12-29 16:27:45] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:27:45] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:27:45] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:27:45] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:27:45] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:27:45] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_001
[2025-12-29 16:27:45] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:27:45] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:27:45] INFO amygdala.py:428:   对话ID: conv_001
[2025-12-29 16:27:45] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:27:45] INFO amygdala.py:430:   关系映射详情: {'conv_001_entity_0': 'conv_001', 'conv_001_entity_1': 'conv_001'}
[2025-12-29 16:27:45] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:27:45] INFO amygdala.py:442:   对话ID: conv_001
[2025-12-29 16:27:45] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:27:45] INFO amygdala.py:444:   粒子ID列表: ['conv_001_entity_0', 'conv_001_entity_1']
[2025-12-29 16:27:45] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:27:45] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:27:45] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:27:45] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:27:45] INFO amygdala.py:298:   输入 - conversation_id: conv_002
[2025-12-29 16:27:45] INFO amygdala.py:299:   输入 - conversation_text: The weather is beautiful today.
[2025-12-29 16:27:45] INFO amygdala.py:300:   输入 - conversation_length: 31 字符
[2025-12-29 16:27:45] INFO particle.py:100: ================================================================================
[2025-12-29 16:27:45] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:27:45] INFO particle.py:102:   输入 - text_id: conv_002
[2025-12-29 16:27:45] INFO particle.py:103:   输入 - text: The weather is beautiful today.
[2025-12-29 16:27:45] INFO particle.py:104:   输入 - text_length: 31 字符
[2025-12-29 16:27:45] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:45] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:27:45] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:27:45] INFO emotion_v2.py:167:   输入 - text_id: conv_002
[2025-12-29 16:27:45] INFO emotion_v2.py:168:   输入 - text: The weather is beautiful today.
[2025-12-29 16:27:45] INFO emotion_v2.py:169:   输入 - text_length: 31 字符
[2025-12-29 16:27:45] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:45] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:27:45] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:27:45] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:27:45] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:27:45] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:27:45] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:27:45] INFO emotion_v2.py:202:   实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:27:45] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:27:46] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, admiration, contentment, happiness
[2025-12-29 16:27:46] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'beautiful' 生成情感描述
[2025-12-29 16:27:50] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, contentment, appreciation, pleasure
[2025-12-29 16:27:50] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'today' 生成情感描述
[2025-12-29 16:27:54] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, satisfaction, peace
[2025-12-29 16:27:54] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:27:54] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:27:54] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:27:54] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:27:54] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_002_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:55] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_002_entity_1, entity=beautiful, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:55] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_002_entity_2, entity=today, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:27:55] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:27:55] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:27:55] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:27:55] INFO emotion_v2.py:277:     1. entity_id=conv_002_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:27:55] INFO emotion_v2.py:277:     2. entity_id=conv_002_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:27:55] INFO emotion_v2.py:277:     3. entity_id=conv_002_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:27:55] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:27:55] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:27:55] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:27:55] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:27:55] INFO particle.py:119:     1. entity_id=conv_002_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:27:55] INFO particle.py:119:     2. entity_id=conv_002_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:27:55] INFO particle.py:119:     3. entity_id=conv_002_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:27:55] INFO particle.py:201: Successfully created 3 particles for text_id: conv_002
[2025-12-29 16:27:55] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:27:55] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:27:55] INFO amygdala.py:316:   粒子 1/3: entity_id=conv_002_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02356536223034282, 0.021463341298995936, -0.027723956094520948, 0.01519136450384201, -0.0028292069075966076], born=1766996865.609862
[2025-12-29 16:27:55] INFO amygdala.py:316:   粒子 2/3: entity_id=conv_002_entity_1, entity=beautiful, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.026329247795914605, 0.014444363436642928, -0.0313369229472931, 0.008334998251961124, -0.008930355269958347], born=1766996865.609862
[2025-12-29 16:27:55] INFO amygdala.py:316:   粒子 3/3: entity_id=conv_002_entity_2, entity=today, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0210075937922864, 0.01802986282172886, -0.026414216738828156, 0.018765536814454847, -0.011292018888349617], born=1766996865.609862
[2025-12-29 16:27:55] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:27:55] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:27:55] INFO linking.py:72: Building hyperbolic links for 3 entities (threshold=2.0, top_k=10)
[2025-12-29 16:27:55] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:27:55] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:27:55] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:27:55] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:27:55] INFO amygdala.py:380:   粒子ID列表: ['conv_002_entity_0', 'conv_002_entity_1', 'conv_002_entity_2']
[2025-12-29 16:27:57] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:27:57] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:27:57] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:27:57] INFO amygdala.py:399:   conversation_id: conv_002
[2025-12-29 16:27:57] INFO amygdala.py:400:   对话内容长度: 31 字符
[2025-12-29 16:27:57] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:27:57] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:27:57] INFO amygdala.py:107:   文本 1: The weather is beautiful today. (长度: 31 字符)
[2025-12-29 16:27:57] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:27:57] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:27:57] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:27:57] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:27:57] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:27:57] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_002
[2025-12-29 16:27:57] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:27:57] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:27:57] INFO amygdala.py:428:   对话ID: conv_002
[2025-12-29 16:27:57] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:27:57] INFO amygdala.py:430:   关系映射详情: {'conv_002_entity_0': 'conv_002', 'conv_002_entity_1': 'conv_002', 'conv_002_entity_2': 'conv_002'}
[2025-12-29 16:27:57] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:27:57] INFO amygdala.py:442:   对话ID: conv_002
[2025-12-29 16:27:57] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:27:57] INFO amygdala.py:444:   粒子ID列表: ['conv_002_entity_0', 'conv_002_entity_1', 'conv_002_entity_2']
[2025-12-29 16:27:57] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:27:57] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:27:57] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:27:57] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:27:57] INFO amygdala.py:298:   输入 - conversation_id: conv_003
[2025-12-29 16:27:57] INFO amygdala.py:299:   输入 - conversation_text: Machine learning is fascinating.
[2025-12-29 16:27:57] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:27:57] INFO particle.py:100: ================================================================================
[2025-12-29 16:27:57] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:27:57] INFO particle.py:102:   输入 - text_id: conv_003
[2025-12-29 16:27:57] INFO particle.py:103:   输入 - text: Machine learning is fascinating.
[2025-12-29 16:27:57] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:27:57] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:57] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:27:57] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:27:57] INFO emotion_v2.py:167:   输入 - text_id: conv_003
[2025-12-29 16:27:57] INFO emotion_v2.py:168:   输入 - text: Machine learning is fascinating.
[2025-12-29 16:27:57] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:27:57] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:27:57] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:28:09] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:28:09] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:28:09] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Machine learning']
[2025-12-29 16:28:09] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:28:09] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:28:09] INFO emotion_v2.py:202:   实体列表: ['Machine learning']
[2025-12-29 16:28:09] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Machine learning' 生成情感描述
[2025-12-29 16:28:18] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: fascination, admiration, interest, curiosity, wonder
[2025-12-29 16:28:18] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:28:18] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:28:18] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:28:18] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:28:19] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_003_entity_0, entity=Machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:28:19] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:28:19] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:28:19] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:28:19] INFO emotion_v2.py:277:     1. entity_id=conv_003_entity_0, entity=Machine learning, vector_shape=(2048,)
[2025-12-29 16:28:19] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:28:19] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:28:19] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:28:19] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:28:19] INFO particle.py:119:     1. entity_id=conv_003_entity_0, entity=Machine learning, vector_shape=(2048,)
[2025-12-29 16:28:19] INFO particle.py:201: Successfully created 1 particles for text_id: conv_003
[2025-12-29 16:28:19] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:28:19] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:28:19] INFO amygdala.py:316:   粒子 1/1: entity_id=conv_003_entity_0, entity=Machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016251810198026826, 0.019568507238440478, -0.027285352332469533, 0.002367291628845233, -0.002114393525763693], born=1766996877.9215248
[2025-12-29 16:28:19] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:28:19] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:28:19] INFO linking.py:72: Building hyperbolic links for 1 entities (threshold=2.0, top_k=10)
[2025-12-29 16:28:19] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:28:19] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:28:19] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:28:19] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:28:19] INFO amygdala.py:380:   粒子ID列表: ['conv_003_entity_0']
[2025-12-29 16:28:23] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:28:23] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:28:23] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:28:23] INFO amygdala.py:399:   conversation_id: conv_003
[2025-12-29 16:28:23] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:28:23] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:28:23] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:28:23] INFO amygdala.py:107:   文本 1: Machine learning is fascinating. (长度: 32 字符)
[2025-12-29 16:28:23] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:28:23] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:28:23] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:28:23] INFO amygdala.py:95: Saved 3 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:28:23] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 3
[2025-12-29 16:28:23] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_003
[2025-12-29 16:28:23] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:28:23] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:28:23] INFO amygdala.py:428:   对话ID: conv_003
[2025-12-29 16:28:23] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:28:23] INFO amygdala.py:430:   关系映射详情: {'conv_003_entity_0': 'conv_003'}
[2025-12-29 16:28:24] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:28:24] INFO amygdala.py:442:   对话ID: conv_003
[2025-12-29 16:28:24] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:28:24] INFO amygdala.py:444:   粒子ID列表: ['conv_003_entity_0']
[2025-12-29 16:28:24] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:28:24] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:28:24] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:28:24] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:28:24] INFO amygdala.py:298:   输入 - conversation_id: conv_004
[2025-12-29 16:28:24] INFO amygdala.py:299:   输入 - conversation_text: I'm working on a new project.
[2025-12-29 16:28:24] INFO amygdala.py:300:   输入 - conversation_length: 29 字符
[2025-12-29 16:28:24] INFO particle.py:100: ================================================================================
[2025-12-29 16:28:24] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:28:24] INFO particle.py:102:   输入 - text_id: conv_004
[2025-12-29 16:28:24] INFO particle.py:103:   输入 - text: I'm working on a new project.
[2025-12-29 16:28:24] INFO particle.py:104:   输入 - text_length: 29 字符
[2025-12-29 16:28:24] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:28:24] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:28:24] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:28:24] INFO emotion_v2.py:167:   输入 - text_id: conv_004
[2025-12-29 16:28:24] INFO emotion_v2.py:168:   输入 - text: I'm working on a new project.
[2025-12-29 16:28:24] INFO emotion_v2.py:169:   输入 - text_length: 29 字符
[2025-12-29 16:28:24] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:28:24] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:28:29] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:28:29] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:28:29] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['project']
[2025-12-29 16:28:29] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:28:29] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:28:29] INFO emotion_v2.py:202:   实体列表: ['project']
[2025-12-29 16:28:29] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'project' 生成情感描述
[2025-12-29 16:28:31] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: anticipation, hope, engagement
[2025-12-29 16:28:31] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:28:31] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:28:31] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:28:31] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:28:31] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_004_entity_0, entity=project, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:28:31] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:28:31] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:28:31] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:28:31] INFO emotion_v2.py:277:     1. entity_id=conv_004_entity_0, entity=project, vector_shape=(2048,)
[2025-12-29 16:28:31] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:28:31] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:28:31] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:28:31] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:28:31] INFO particle.py:119:     1. entity_id=conv_004_entity_0, entity=project, vector_shape=(2048,)
[2025-12-29 16:28:31] INFO particle.py:201: Successfully created 1 particles for text_id: conv_004
[2025-12-29 16:28:31] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:28:31] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:28:31] INFO amygdala.py:316:   粒子 1/1: entity_id=conv_004_entity_0, entity=project, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.01601270779449989, 0.023313519700804454, -0.03965752549105261, 0.01601270779449989, -0.01955881674899067], born=1766996904.1952724
[2025-12-29 16:28:31] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:28:31] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:28:31] INFO linking.py:72: Building hyperbolic links for 1 entities (threshold=2.0, top_k=10)
[2025-12-29 16:28:31] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:28:31] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:28:31] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:28:31] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:28:31] INFO amygdala.py:380:   粒子ID列表: ['conv_004_entity_0']
[2025-12-29 16:28:32] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:28:32] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:28:32] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:28:32] INFO amygdala.py:399:   conversation_id: conv_004
[2025-12-29 16:28:32] INFO amygdala.py:400:   对话内容长度: 29 字符
[2025-12-29 16:28:32] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:28:32] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:28:32] INFO amygdala.py:107:   文本 1: I'm working on a new project. (长度: 29 字符)
[2025-12-29 16:28:32] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:28:32] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:28:32] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:28:33] INFO amygdala.py:95: Saved 4 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:28:33] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 4
[2025-12-29 16:28:33] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_004
[2025-12-29 16:28:33] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:28:33] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:28:33] INFO amygdala.py:428:   对话ID: conv_004
[2025-12-29 16:28:33] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:28:33] INFO amygdala.py:430:   关系映射详情: {'conv_004_entity_0': 'conv_004'}
[2025-12-29 16:28:33] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:28:33] INFO amygdala.py:442:   对话ID: conv_004
[2025-12-29 16:28:33] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:28:33] INFO amygdala.py:444:   粒子ID列表: ['conv_004_entity_0']
[2025-12-29 16:28:33] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:28:33] INFO amygdala.py:446: ================================================================================
Traceback (most recent call last):
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 667, in test_amygdala_integration
    assert text is not None, f"对话 {conv_id} 的文本应该存在"
AssertionError: 对话 conv_001 的文本应该存在
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 743, in <module>
    main()
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 739, in main
    raise AssertionError(f"{failed} 个测试失败")
AssertionError: 2 个测试失败

【Step 5】测试长对话...
  ✓ 长对话处理成功: 1 个粒子

====================================================================================================
✓ 测试7完成：边界情况处理正常
====================================================================================================

✓ 边界情况 测试通过

====================================================================================================
测试8：集成测试
====================================================================================================

【Step 1】初始化 Amygdala...
✓ 初始化成功

【Step 2】添加多个对话...
  ✓ conv_001: 2 个粒子
  ✓ conv_002: 3 个粒子
  ✓ conv_003: 1 个粒子
  ✓ conv_004: 1 个粒子

【Step 3】验证所有功能...
  ✓ 验证了 7 个粒子的映射关系

❌ 测试8失败: 对话 conv_001 的文本应该存在

❌ 集成测试 测试失败: 对话 conv_001 的文本应该存在

====================================================================================================
测试总结
====================================================================================================
总测试数: 8
通过: 6
失败: 2
====================================================================================================
