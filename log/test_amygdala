WARNING 12-29 16:36:34 [importing.py:53] Triton is installed, but `triton.backends` could not be imported. Disabling Triton.
INFO 12-29 16:36:34 [importing.py:68] Triton not installed or not compatible; certain GPU-related functions will not be available.
[2025-12-29 16:36:41] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_basic
[2025-12-29 16:36:41] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:36:41] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:36:42] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:36:42] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:36:42] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:36:42] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:36:42] INFO speed.py:22: Speed module initialized
[2025-12-29 16:36:42] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:36:42] INFO particle.py:79: Particle module initialized
[2025-12-29 16:36:42] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:36:42] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:36:42] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_basic, collection=test_particles_basic
[2025-12-29 16:36:42] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_basic, collection=test_particles_basic
[2025-12-29 16:36:42] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_basic
[2025-12-29 16:36:42] INFO amygdala.py:39: Creating working directory: test_amygdala_basic/conversation_embeddings
[2025-12-29 16:36:42] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:36:42] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:36:42] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:36:42] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:36:42] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:36:42] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:36:42] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming and I'm excited about machine learning!
[2025-12-29 16:36:42] INFO amygdala.py:300:   输入 - conversation_length: 65 字符
[2025-12-29 16:36:42] INFO particle.py:100: ================================================================================
[2025-12-29 16:36:42] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:36:42] INFO particle.py:102:   输入 - text_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:36:42] INFO particle.py:103:   输入 - text: I love Python programming and I'm excited about machine learning!
[2025-12-29 16:36:42] INFO particle.py:104:   输入 - text_length: 65 字符
[2025-12-29 16:36:42] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:36:42] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:36:42] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:36:42] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:36:42] INFO emotion_v2.py:168:   输入 - text: I love Python programming and I'm excited about machine learning!
[2025-12-29 16:36:42] INFO emotion_v2.py:169:   输入 - text_length: 65 字符
[2025-12-29 16:36:42] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:36:42] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:36:43] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:36:43] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:36:43] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:36:43] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:36:43] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:36:43] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:36:43] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:36:47] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, excitement, enthusiasm, hope
[2025-12-29 16:36:47] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:37:48] WARNING completion_client.py:282: [CompletionClient] 请求超时（60秒），尝试 1/3
[2025-12-29 16:37:48] WARNING completion_client.py:283:   URL: https://llmapi.paratera.com/v1/chat/completions
[2025-12-29 16:37:48] WARNING completion_client.py:284:   Model: DeepSeek-V3.2
[2025-12-29 16:37:48] INFO completion_client.py:287: [CompletionClient] 等待 2.0 秒后重试...
[2025-12-29 16:37:53] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, excitement, hope
[2025-12-29 16:37:53] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'machine learning' 生成情感描述
[2025-12-29 16:37:55] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, admiration, joy
[2025-12-29 16:37:55] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:37:56] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:37:56] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:37:56] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:37:56] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:37:57] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:37:57] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:37:57] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:37:57] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:37:57] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:37:57] INFO emotion_v2.py:277:     1. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:37:57] INFO emotion_v2.py:277:     2. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:37:57] INFO emotion_v2.py:277:     3. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:37:57] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:37:57] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:37:57] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:37:57] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:37:57] INFO particle.py:119:     1. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:37:57] INFO particle.py:119:     2. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:37:57] INFO particle.py:119:     3. entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:37:57] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:37:57] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:37:57] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:37:57] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.0034771949824866076, 0.011681112941166395, -0.023769312880282438, 0.011392760942618721, -0.014779491925560963], born=1766997402.7692952
[2025-12-29 16:37:57] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.015598036356646404, 0.011312296258653699, -0.03943568090169003, 0.009738759222675046, -0.016833978384906006], born=1766997402.7692952
[2025-12-29 16:37:57] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2, entity=machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02408501585814491, 0.009526245339418456, -0.02275189681064611, 6.040695215228915e-05, -0.005440791793854461], born=1766997402.7692952
[2025-12-29 16:37:57] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:37:57] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:37:57] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2']
[2025-12-29 16:37:57] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:37:57] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:37:57] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:37:57] INFO amygdala.py:399:   conversation_id: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:37:57] INFO amygdala.py:400:   对话内容长度: 65 字符
[2025-12-29 16:37:57] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:37:57] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:37:57] INFO amygdala.py:107:   文本 1: I love Python programming and I'm excited about machine learning! (长度: 65 字符)
[2025-12-29 16:37:57] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:37:57] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:37:57] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:37:58] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_basic/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:37:58] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:37:58] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:37:58] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:37:58] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:37:58] INFO amygdala.py:428:   对话ID: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:37:58] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:37:58] INFO amygdala.py:430:   关系映射详情: {'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0': 'test_conversation-a303c4404f2ed0d8ad548c735f18a136', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1': 'test_conversation-a303c4404f2ed0d8ad548c735f18a136', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2': 'test_conversation-a303c4404f2ed0d8ad548c735f18a136'}
[2025-12-29 16:37:58] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:37:58] INFO amygdala.py:442:   对话ID: test_conversation-a303c4404f2ed0d8ad548c735f18a136
[2025-12-29 16:37:58] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:37:58] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1', 'test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2']
[2025-12-29 16:37:58] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:37:58] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:37:58] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_multiple
[2025-12-29 16:37:58] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:37:58] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:37:58] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:37:58] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:37:58] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:37:58] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:37:58] INFO speed.py:22: Speed module initialized
[2025-12-29 16:37:58] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:37:58] INFO particle.py:79: Particle module initialized
[2025-12-29 16:37:58] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:37:58] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:37:58] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_multiple, collection=test_particles_multiple
[2025-12-29 16:37:58] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_multiple, collection=test_particles_multiple
[2025-12-29 16:37:58] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_multiple
[2025-12-29 16:37:58] INFO amygdala.py:39: Creating working directory: test_amygdala_multiple/conversation_embeddings
[2025-12-29 16:37:58] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:37:58] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:37:58] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:37:58] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:37:58] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:37:58] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:37:58] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming and machine learning!
[2025-12-29 16:37:58] INFO amygdala.py:300:   输入 - conversation_length: 47 字符
[2025-12-29 16:37:58] INFO particle.py:100: ================================================================================
[2025-12-29 16:37:58] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:37:58] INFO particle.py:102:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:37:58] INFO particle.py:103:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:37:58] INFO particle.py:104:   输入 - text_length: 47 字符
[2025-12-29 16:37:58] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:37:58] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:37:58] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:37:58] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:37:58] INFO emotion_v2.py:168:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:37:58] INFO emotion_v2.py:169:   输入 - text_length: 47 字符
[2025-12-29 16:37:58] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:37:58] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:37:58] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:37:58] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:37:58] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:37:58] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:37:58] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:37:58] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:37:58] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:38:02] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, love, admiration, enthusiasm, excitement
[2025-12-29 16:38:02] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:38:06] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, admiration, passion, enthusiasm
[2025-12-29 16:38:06] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'machine learning' 生成情感描述
[2025-12-29 16:38:09] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, love, admiration, enthusiasm, excitement
[2025-12-29 16:38:09] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:38:09] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:38:09] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:38:09] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:38:10] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:10] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:10] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:10] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:38:10] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:38:10] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:38:10] INFO emotion_v2.py:277:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:38:10] INFO emotion_v2.py:277:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:38:11] INFO emotion_v2.py:277:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:38:11] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:38:11] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:38:11] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:38:11] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:38:11] INFO particle.py:119:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:38:11] INFO particle.py:119:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:38:11] INFO particle.py:119:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:38:11] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:38:11] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:38:11] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:38:11] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.015502238541393487, 0.009837098343546577, -0.030445232063256143, 0.014417305503503754, -0.0026354364920388464], born=1766997478.8322568
[2025-12-29 16:38:11] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.009837083017413501, 0.010181155018022576, -0.029353315051960933, 0.014710500026040373, -0.0024663215043658564], born=1766997478.8322568
[2025-12-29 16:38:11] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.015502238541393487, 0.009837098343546577, -0.030445232063256143, 0.014417305503503754, -0.0026354364920388464], born=1766997478.8322568
[2025-12-29 16:38:11] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:38:11] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:38:11] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:38:11] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:38:11] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:38:11] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:38:11] INFO amygdala.py:399:   conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:38:11] INFO amygdala.py:400:   对话内容长度: 47 字符
[2025-12-29 16:38:11] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:38:11] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:38:11] INFO amygdala.py:107:   文本 1: I love Python programming and machine learning! (长度: 47 字符)
[2025-12-29 16:38:11] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:38:11] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:38:11] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:38:11] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:38:11] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:38:11] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:38:11] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:38:11] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:38:11] INFO amygdala.py:428:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:38:11] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:38:11] INFO amygdala.py:430:   关系映射详情: {'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e'}
[2025-12-29 16:38:11] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:38:11] INFO amygdala.py:442:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:38:11] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:38:11] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:38:11] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:38:11] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:38:11] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:38:11] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:38:11] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:11] INFO amygdala.py:299:   输入 - conversation_text: The weather is beautiful today, I feel happy.
[2025-12-29 16:38:11] INFO amygdala.py:300:   输入 - conversation_length: 45 字符
[2025-12-29 16:38:11] INFO particle.py:100: ================================================================================
[2025-12-29 16:38:11] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:38:11] INFO particle.py:102:   输入 - text_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:11] INFO particle.py:103:   输入 - text: The weather is beautiful today, I feel happy.
[2025-12-29 16:38:11] INFO particle.py:104:   输入 - text_length: 45 字符
[2025-12-29 16:38:11] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:38:11] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:38:11] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:38:11] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:11] INFO emotion_v2.py:168:   输入 - text: The weather is beautiful today, I feel happy.
[2025-12-29 16:38:11] INFO emotion_v2.py:169:   输入 - text_length: 45 字符
[2025-12-29 16:38:11] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:38:11] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:38:11] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:38:11] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:38:11] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather', 'beautiful', 'happy']
[2025-12-29 16:38:11] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:38:11] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:38:11] INFO emotion_v2.py:202:   实体列表: ['weather', 'beautiful', 'happy']
[2025-12-29 16:38:11] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:38:13] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, happiness, contentment
[2025-12-29 16:38:13] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'beautiful' 生成情感描述
[2025-12-29 16:38:14] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, happiness, admiration, contentment, delight
[2025-12-29 16:38:14] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'happy' 生成情感描述
[2025-12-29 16:38:20] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, elation, delight, cheerfulness, bliss
[2025-12-29 16:38:20] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:38:20] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:38:20] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:38:20] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:38:21] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:21] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:22] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:22] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:38:22] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:38:22] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:38:22] INFO emotion_v2.py:277:     1. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:38:22] INFO emotion_v2.py:277:     2. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:38:22] INFO emotion_v2.py:277:     3. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, vector_shape=(2048,)
[2025-12-29 16:38:22] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:38:22] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:38:22] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:38:22] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:38:22] INFO particle.py:119:     1. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:38:22] INFO particle.py:119:     2. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:38:22] INFO particle.py:119:     3. entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, vector_shape=(2048,)
[2025-12-29 16:38:22] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:22] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:38:22] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:38:22] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02057017151074067, 0.017043519594621706, -0.024792717410307863, 0.014189171662512068, -0.0044142122950084324], born=1766997491.4290538
[2025-12-29 16:38:22] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1, entity=beautiful, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01936803350675633, 0.012348670185517718, -0.022680541422397043, 0.011920522696421305, -5.9944148473408685e-05], born=1766997491.4290538
[2025-12-29 16:38:22] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2, entity=happy, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.013697873490514146, 0.0045594511632717155, -0.017780464636709736, 0.024607090881167887, 0.0009488398339774902], born=1766997491.4290538
[2025-12-29 16:38:22] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:38:22] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:38:22] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2']
[2025-12-29 16:38:24] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:38:24] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:38:24] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:38:24] INFO amygdala.py:399:   conversation_id: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:24] INFO amygdala.py:400:   对话内容长度: 45 字符
[2025-12-29 16:38:24] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:38:24] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:38:24] INFO amygdala.py:107:   文本 1: The weather is beautiful today, I feel happy. (长度: 45 字符)
[2025-12-29 16:38:24] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:38:24] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:38:24] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:38:24] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:38:24] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:38:24] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:24] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:38:24] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:38:24] INFO amygdala.py:428:   对话ID: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:24] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:38:24] INFO amygdala.py:430:   关系映射详情: {'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0': 'test_conversation-83524becd2b7394577cc4ea2e2f8d724', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1': 'test_conversation-83524becd2b7394577cc4ea2e2f8d724', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2': 'test_conversation-83524becd2b7394577cc4ea2e2f8d724'}
[2025-12-29 16:38:24] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:38:24] INFO amygdala.py:442:   对话ID: test_conversation-83524becd2b7394577cc4ea2e2f8d724
[2025-12-29 16:38:24] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:38:24] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_0', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_1', 'test_conversation-83524becd2b7394577cc4ea2e2f8d724_entity_2']
[2025-12-29 16:38:24] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:38:24] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:38:24] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:38:24] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:38:24] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:24] INFO amygdala.py:299:   输入 - conversation_text: I'm frustrated with this bug in my code.
[2025-12-29 16:38:24] INFO amygdala.py:300:   输入 - conversation_length: 40 字符
[2025-12-29 16:38:24] INFO particle.py:100: ================================================================================
[2025-12-29 16:38:24] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:38:24] INFO particle.py:102:   输入 - text_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:24] INFO particle.py:103:   输入 - text: I'm frustrated with this bug in my code.
[2025-12-29 16:38:24] INFO particle.py:104:   输入 - text_length: 40 字符
[2025-12-29 16:38:24] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:38:24] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:38:24] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:38:24] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:24] INFO emotion_v2.py:168:   输入 - text: I'm frustrated with this bug in my code.
[2025-12-29 16:38:24] INFO emotion_v2.py:169:   输入 - text_length: 40 字符
[2025-12-29 16:38:24] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:38:24] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:38:24] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:38:24] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:38:24] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['frustrated', 'bug', 'code']
[2025-12-29 16:38:24] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:38:24] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:38:24] INFO emotion_v2.py:202:   实体列表: ['frustrated', 'bug', 'code']
[2025-12-29 16:38:24] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'frustrated' 生成情感描述
[2025-12-29 16:38:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, irritation, annoyance, impatience, helplessness
[2025-12-29 16:38:32] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'bug' 生成情感描述
[2025-12-29 16:38:35] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, annoyance, disappointment, helplessness
[2025-12-29 16:38:35] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'code' 生成情感描述
[2025-12-29 16:38:36] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration
[2025-12-29 16:38:36] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:38:36] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:38:36] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:38:36] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:38:37] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:37] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:38] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:38] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:38:38] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:38:38] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:38:38] INFO emotion_v2.py:277:     1. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, vector_shape=(2048,)
[2025-12-29 16:38:38] INFO emotion_v2.py:277:     2. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, vector_shape=(2048,)
[2025-12-29 16:38:38] INFO emotion_v2.py:277:     3. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, vector_shape=(2048,)
[2025-12-29 16:38:38] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:38:38] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:38:38] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:38:38] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:38:38] INFO particle.py:119:     1. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, vector_shape=(2048,)
[2025-12-29 16:38:38] INFO particle.py:119:     2. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, vector_shape=(2048,)
[2025-12-29 16:38:38] INFO particle.py:119:     3. entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, vector_shape=(2048,)
[2025-12-29 16:38:38] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:38] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:38:38] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:38:38] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_0, entity=frustrated, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0016710082207795865, 0.03132996738959938, -0.030411200378174186, 0.021269465264493432, 0.0008965160111484982], born=1766997504.7108681
[2025-12-29 16:38:38] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_1, entity=bug, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.005107198088571998, 0.02321453840260002, -0.037542902651090844, 0.03027881052511273, -0.0057419245995797945], born=1766997504.7108681
[2025-12-29 16:38:38] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-028403027411873a0426c8a1906d39af_entity_2, entity=code, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.00788849432317714, 0.021348126874593597, -0.033426831369435965, 0.030913891266485416, -0.025650944050872124], born=1766997504.7108681
[2025-12-29 16:38:38] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:38:38] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:38:38] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-028403027411873a0426c8a1906d39af_entity_0', 'test_conversation-028403027411873a0426c8a1906d39af_entity_1', 'test_conversation-028403027411873a0426c8a1906d39af_entity_2']
[2025-12-29 16:38:41] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:38:41] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:38:41] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:38:41] INFO amygdala.py:399:   conversation_id: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:41] INFO amygdala.py:400:   对话内容长度: 40 字符
[2025-12-29 16:38:41] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:38:41] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:38:41] INFO amygdala.py:107:   文本 1: I'm frustrated with this bug in my code. (长度: 40 字符)
[2025-12-29 16:38:41] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:38:41] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:38:41] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:38:41] INFO amygdala.py:95: Saved 3 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:38:41] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 3
[2025-12-29 16:38:41] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:41] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:38:41] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:38:41] INFO amygdala.py:428:   对话ID: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:41] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:38:41] INFO amygdala.py:430:   关系映射详情: {'test_conversation-028403027411873a0426c8a1906d39af_entity_0': 'test_conversation-028403027411873a0426c8a1906d39af', 'test_conversation-028403027411873a0426c8a1906d39af_entity_1': 'test_conversation-028403027411873a0426c8a1906d39af', 'test_conversation-028403027411873a0426c8a1906d39af_entity_2': 'test_conversation-028403027411873a0426c8a1906d39af'}
[2025-12-29 16:38:42] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:38:42] INFO amygdala.py:442:   对话ID: test_conversation-028403027411873a0426c8a1906d39af
[2025-12-29 16:38:42] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:38:42] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-028403027411873a0426c8a1906d39af_entity_0', 'test_conversation-028403027411873a0426c8a1906d39af_entity_1', 'test_conversation-028403027411873a0426c8a1906d39af_entity_2']
[2025-12-29 16:38:42] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:38:42] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:38:42] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:38:42] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:38:42] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:38:42] INFO amygdala.py:299:   输入 - conversation_text: Learning new technologies is exciting and challenging.
[2025-12-29 16:38:42] INFO amygdala.py:300:   输入 - conversation_length: 54 字符
[2025-12-29 16:38:42] INFO particle.py:100: ================================================================================
[2025-12-29 16:38:42] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:38:42] INFO particle.py:102:   输入 - text_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:38:42] INFO particle.py:103:   输入 - text: Learning new technologies is exciting and challenging.
[2025-12-29 16:38:42] INFO particle.py:104:   输入 - text_length: 54 字符
[2025-12-29 16:38:42] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:38:42] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:38:42] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:38:42] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:38:42] INFO emotion_v2.py:168:   输入 - text: Learning new technologies is exciting and challenging.
[2025-12-29 16:38:42] INFO emotion_v2.py:169:   输入 - text_length: 54 字符
[2025-12-29 16:38:42] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:38:42] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:38:44] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:38:44] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 4
[2025-12-29 16:38:44] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['learning', 'technologies', 'exciting', 'challenging']
[2025-12-29 16:38:44] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:38:44] INFO emotion_v2.py:201:   实体数量: 4
[2025-12-29 16:38:44] INFO emotion_v2.py:202:   实体列表: ['learning', 'technologies', 'exciting', 'challenging']
[2025-12-29 16:38:44] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'learning' 生成情感描述
[2025-12-29 16:38:46] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, challenge
[2025-12-29 16:38:46] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'technologies' 生成情感描述
[2025-12-29 16:38:49] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, challenge, curiosity, anticipation, engagement
[2025-12-29 16:38:49] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'exciting' 生成情感描述
[2025-12-29 16:38:50] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, anticipation, enthusiasm, curiosity, engagement
[2025-12-29 16:38:50] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'challenging' 生成情感描述
[2025-12-29 16:38:55] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: excitement, determination, anxiety, curiosity, hope, resilience
[2025-12-29 16:38:55] INFO sentence.py:120: Generated 4 affective descriptions for 4 entities
[2025-12-29 16:38:55] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:38:55] INFO emotion_v2.py:210:   成功生成: 4/4 个描述
[2025-12-29 16:38:55] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:38:56] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:57] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:57] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:58] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:38:58] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:38:58] INFO emotion_v2.py:274:   成功处理: 4/4 个实体
[2025-12-29 16:38:58] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:38:58] INFO emotion_v2.py:277:     1. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO emotion_v2.py:277:     2. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO emotion_v2.py:277:     3. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO emotion_v2.py:277:     4. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:38:58] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:38:58] INFO particle.py:115:   提取结果 - emotion_nodes数量: 4
[2025-12-29 16:38:58] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:38:58] INFO particle.py:119:     1. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO particle.py:119:     2. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO particle.py:119:     3. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO particle.py:119:     4. entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, vector_shape=(2048,)
[2025-12-29 16:38:58] INFO particle.py:201: Successfully created 4 particles for text_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:38:58] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 4 个粒子
[2025-12-29 16:38:58] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:38:58] INFO amygdala.py:316:   粒子 1/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_0, entity=learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02006239831252087, -0.0016287470253717143, -0.036808506573382416, 0.0007191917512031687, -0.01658146625829685], born=1766997522.7125342
[2025-12-29 16:38:58] INFO amygdala.py:316:   粒子 2/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_1, entity=technologies, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016522790085958382, 0.016097695083746862, -0.02742984514270139, 0.004827071025112418, -0.006600166734336795], born=1766997522.7125342
[2025-12-29 16:38:58] INFO amygdala.py:316:   粒子 3/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_2, entity=exciting, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.005576552989874364, 0.025180432954278582, -0.0277503239496123, 0.009913244982000007, -0.008943900483760096], born=1766997522.7125342
[2025-12-29 16:38:58] INFO amygdala.py:316:   粒子 4/4: entity_id=test_conversation-e05db879cb2c698162903b78288164db_entity_3, entity=challenging, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.004095137997926895, 0.008586668995653121, -0.0253915299871459, 0.0036624546981459346, -0.009385039995248957], born=1766997522.7125342
[2025-12-29 16:38:58] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:38:58] INFO amygdala.py:378:   粒子数量: 4
[2025-12-29 16:38:58] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-e05db879cb2c698162903b78288164db_entity_0', 'test_conversation-e05db879cb2c698162903b78288164db_entity_1', 'test_conversation-e05db879cb2c698162903b78288164db_entity_2', 'test_conversation-e05db879cb2c698162903b78288164db_entity_3']
[2025-12-29 16:39:00] INFO storage.py:128: Batch upserted 4 entities
[2025-12-29 16:39:00] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 4 个粒子已存储到数据库
[2025-12-29 16:39:00] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:39:00] INFO amygdala.py:399:   conversation_id: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:39:00] INFO amygdala.py:400:   对话内容长度: 54 字符
[2025-12-29 16:39:00] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:39:00] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:39:00] INFO amygdala.py:107:   文本 1: Learning new technologies is exciting and challenging. (长度: 54 字符)
[2025-12-29 16:39:00] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:39:00] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:39:00] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:39:00] INFO amygdala.py:95: Saved 4 conversation records to test_amygdala_multiple/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:39:00] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 4
[2025-12-29 16:39:00] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:39:00] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:39:00] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:39:00] INFO amygdala.py:428:   对话ID: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:39:00] INFO amygdala.py:429:   关联粒子数: 4
[2025-12-29 16:39:00] INFO amygdala.py:430:   关系映射详情: {'test_conversation-e05db879cb2c698162903b78288164db_entity_0': 'test_conversation-e05db879cb2c698162903b78288164db', 'test_conversation-e05db879cb2c698162903b78288164db_entity_1': 'test_conversation-e05db879cb2c698162903b78288164db', 'test_conversation-e05db879cb2c698162903b78288164db_entity_2': 'test_conversation-e05db879cb2c698162903b78288164db', 'test_conversation-e05db879cb2c698162903b78288164db_entity_3': 'test_conversation-e05db879cb2c698162903b78288164db'}
[2025-12-29 16:39:01] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:39:01] INFO amygdala.py:442:   对话ID: test_conversation-e05db879cb2c698162903b78288164db
[2025-12-29 16:39:01] INFO amygdala.py:443:   生成粒子数: 4
[2025-12-29 16:39:01] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-e05db879cb2c698162903b78288164db_entity_0', 'test_conversation-e05db879cb2c698162903b78288164db_entity_1', 'test_conversation-e05db879cb2c698162903b78288164db_entity_2', 'test_conversation-e05db879cb2c698162903b78288164db_entity_3']
[2025-12-29 16:39:01] INFO amygdala.py:445:   关系映射数: 4
[2025-12-29 16:39:01] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:39:01] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_relationship
[2025-12-29 16:39:02] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:39:02] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:39:02] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:39:03] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:39:03] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:39:03] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:39:03] INFO speed.py:22: Speed module initialized
[2025-12-29 16:39:03] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:39:03] INFO particle.py:79: Particle module initialized
[2025-12-29 16:39:03] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:39:03] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:39:05] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_relationship, collection=test_particles_relationship
[2025-12-29 16:39:05] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_relationship, collection=test_particles_relationship
[2025-12-29 16:39:05] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_relationship
[2025-12-29 16:39:05] INFO amygdala.py:39: Creating working directory: test_amygdala_relationship/conversation_embeddings
[2025-12-29 16:39:05] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:39:05] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:39:05] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:39:05] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:39:05] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:39:05] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:05] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming!
[2025-12-29 16:39:05] INFO amygdala.py:300:   输入 - conversation_length: 26 字符
[2025-12-29 16:39:05] INFO particle.py:100: ================================================================================
[2025-12-29 16:39:05] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:39:05] INFO particle.py:102:   输入 - text_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:05] INFO particle.py:103:   输入 - text: I love Python programming!
[2025-12-29 16:39:06] INFO particle.py:104:   输入 - text_length: 26 字符
[2025-12-29 16:39:06] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:06] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:39:06] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:39:06] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:06] INFO emotion_v2.py:168:   输入 - text: I love Python programming!
[2025-12-29 16:39:06] INFO emotion_v2.py:169:   输入 - text_length: 26 字符
[2025-12-29 16:39:06] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:06] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:39:06] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:39:06] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:39:06] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming']
[2025-12-29 16:39:06] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:39:06] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:39:06] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming']
[2025-12-29 16:39:06] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:39:11] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, love, admiration, enthusiasm, satisfaction
[2025-12-29 16:39:11] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:39:15] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, love, enthusiasm, satisfaction, admiration
[2025-12-29 16:39:15] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:39:15] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:39:15] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:39:15] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:39:15] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:16] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:16] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:39:16] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:39:16] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:39:16] INFO emotion_v2.py:277:     1. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:39:16] INFO emotion_v2.py:277:     2. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:39:16] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:39:16] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:39:16] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:39:16] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:39:16] INFO particle.py:119:     1. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:39:16] INFO particle.py:119:     2. entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:39:16] INFO particle.py:201: Successfully created 2 particles for text_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:16] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:39:16] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:39:16] INFO amygdala.py:316:   粒子 1/2: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.019406391143552654, 0.009050641066949262, -0.0336831402491604, 0.01491227911030888, -0.0018994998140509508], born=1766997545.9452765
[2025-12-29 16:39:16] INFO amygdala.py:316:   粒子 2/2: entity_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01969098911124548, 0.00913213505159257, -0.032678660184620144, 0.015410830087064453, 0.0002752945015552936], born=1766997545.9452765
[2025-12-29 16:39:16] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:39:16] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:39:16] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0', 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1']
[2025-12-29 16:39:22] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:39:22] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:39:22] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:39:22] INFO amygdala.py:399:   conversation_id: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:22] INFO amygdala.py:400:   对话内容长度: 26 字符
[2025-12-29 16:39:22] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:39:22] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:39:22] INFO amygdala.py:107:   文本 1: I love Python programming! (长度: 26 字符)
[2025-12-29 16:39:22] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:39:22] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:39:22] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:39:23] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_relationship/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:39:23] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:39:23] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:23] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:39:23] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:39:23] INFO amygdala.py:428:   对话ID: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:23] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:39:23] INFO amygdala.py:430:   关系映射详情: {'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0': 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2', 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1': 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2'}
[2025-12-29 16:39:24] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:39:24] INFO amygdala.py:442:   对话ID: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
[2025-12-29 16:39:24] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:39:24] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_0', 'test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2_entity_1']
[2025-12-29 16:39:24] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:39:24] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:39:24] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:39:24] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:39:24] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:24] INFO amygdala.py:299:   输入 - conversation_text: The weather is beautiful today.
[2025-12-29 16:39:24] INFO amygdala.py:300:   输入 - conversation_length: 31 字符
[2025-12-29 16:39:24] INFO particle.py:100: ================================================================================
[2025-12-29 16:39:24] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:39:24] INFO particle.py:102:   输入 - text_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:24] INFO particle.py:103:   输入 - text: The weather is beautiful today.
[2025-12-29 16:39:24] INFO particle.py:104:   输入 - text_length: 31 字符
[2025-12-29 16:39:24] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:24] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:39:24] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:39:24] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:24] INFO emotion_v2.py:168:   输入 - text: The weather is beautiful today.
[2025-12-29 16:39:24] INFO emotion_v2.py:169:   输入 - text_length: 31 字符
[2025-12-29 16:39:24] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:24] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:39:25] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:39:25] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:39:25] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:39:25] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:39:25] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:39:25] INFO emotion_v2.py:202:   实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:39:25] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:39:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, admiration, pleasure, serenity
[2025-12-29 16:39:32] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'beautiful' 生成情感描述
[2025-12-29 16:39:33] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, admiration, contentment, serenity, appreciation
[2025-12-29 16:39:33] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'today' 生成情感描述
[2025-12-29 16:39:35] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, appreciation, satisfaction
[2025-12-29 16:39:35] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:39:35] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:39:35] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:39:35] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:39:35] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:36] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:36] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:36] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:39:36] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:39:37] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:39:37] INFO emotion_v2.py:277:     1. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:39:37] INFO emotion_v2.py:277:     2. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:39:37] INFO emotion_v2.py:277:     3. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:39:37] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:39:37] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:39:37] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:39:37] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:39:37] INFO particle.py:119:     1. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:39:37] INFO particle.py:119:     2. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:39:37] INFO particle.py:119:     3. entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:39:37] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:37] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:39:37] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:39:37] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.015584344410221895, 0.023821621098488188, -0.02136508919145384, 0.02192851217013151, 0.006006113772703021], born=1766997564.22098
[2025-12-29 16:39:37] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1, entity=beautiful, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01868056841188526, 0.02628193917257358, -0.025171754207525203, 0.022679501285988054, 0.00455968985644865], born=1766997564.22098
[2025-12-29 16:39:37] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2, entity=today, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.026453317460840082, 0.017135329650755225, -0.022032799550937142, 0.01772860963866325, -0.00366437772531426], born=1766997564.22098
[2025-12-29 16:39:37] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:39:37] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:39:37] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2']
[2025-12-29 16:39:37] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:39:37] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:39:37] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:39:37] INFO amygdala.py:399:   conversation_id: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:37] INFO amygdala.py:400:   对话内容长度: 31 字符
[2025-12-29 16:39:37] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:39:37] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:39:37] INFO amygdala.py:107:   文本 1: The weather is beautiful today. (长度: 31 字符)
[2025-12-29 16:39:37] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:39:37] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:39:37] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:39:37] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_relationship/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:39:37] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:39:37] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:37] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:39:37] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:39:37] INFO amygdala.py:428:   对话ID: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:37] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:39:37] INFO amygdala.py:430:   关系映射详情: {'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0': 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1': 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2': 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb'}
[2025-12-29 16:39:38] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:39:38] INFO amygdala.py:442:   对话ID: test_conversation-042bc3ca359baf149ebbe296e0f5adfb
[2025-12-29 16:39:38] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:39:38] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_0', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_1', 'test_conversation-042bc3ca359baf149ebbe296e0f5adfb_entity_2']
[2025-12-29 16:39:38] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:39:38] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:39:38] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_persistence
[2025-12-29 16:39:38] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:39:38] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:39:38] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:39:38] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:39:38] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:39:38] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:39:38] INFO speed.py:22: Speed module initialized
[2025-12-29 16:39:38] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:39:38] INFO particle.py:79: Particle module initialized
[2025-12-29 16:39:38] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:39:38] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:39:38] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:39:38] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:39:38] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_persistence
[2025-12-29 16:39:38] INFO amygdala.py:39: Creating working directory: test_amygdala_persistence/conversation_embeddings
[2025-12-29 16:39:38] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:39:38] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:39:38] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:39:38] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:39:38] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:39:38] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:38] INFO amygdala.py:299:   输入 - conversation_text: First conversation about Python.
[2025-12-29 16:39:38] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:39:38] INFO particle.py:100: ================================================================================
[2025-12-29 16:39:38] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:39:38] INFO particle.py:102:   输入 - text_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:38] INFO particle.py:103:   输入 - text: First conversation about Python.
[2025-12-29 16:39:38] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:39:38] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:38] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:39:38] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:39:38] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:38] INFO emotion_v2.py:168:   输入 - text: First conversation about Python.
[2025-12-29 16:39:38] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:39:38] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:38] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:39:38] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:39:38] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:39:38] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python']
[2025-12-29 16:39:38] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:39:38] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:39:38] INFO emotion_v2.py:202:   实体列表: ['Python']
[2025-12-29 16:39:38] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:39:39] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: hope, interest, curiosity
[2025-12-29 16:39:39] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:39:39] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:39:39] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:39:39] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:39:40] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:40] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:39:40] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:39:40] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:39:40] INFO emotion_v2.py:277:     1. entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:39:40] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:39:40] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:39:40] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:39:40] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:39:40] INFO particle.py:119:     1. entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:39:40] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:40] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:39:40] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:39:40] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.0012832788761566551, 0.01761481967271633, -0.03934581526895403, 0.010580997803404869, -0.013389683751219433], born=1766997578.730294
[2025-12-29 16:39:40] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:39:40] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:39:40] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0']
[2025-12-29 16:39:45] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:39:45] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:39:45] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:39:45] INFO amygdala.py:399:   conversation_id: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:45] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:39:45] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:39:45] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:39:45] INFO amygdala.py:107:   文本 1: First conversation about Python. (长度: 32 字符)
[2025-12-29 16:39:45] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:39:45] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:39:45] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:39:45] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:39:45] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:39:45] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:45] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:39:45] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:39:45] INFO amygdala.py:428:   对话ID: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:45] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:39:45] INFO amygdala.py:430:   关系映射详情: {'test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0': 'test_conversation-31e267c3b73671aaeaf38198bf1b5afb'}
[2025-12-29 16:39:46] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:39:46] INFO amygdala.py:442:   对话ID: test_conversation-31e267c3b73671aaeaf38198bf1b5afb
[2025-12-29 16:39:46] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:39:46] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-31e267c3b73671aaeaf38198bf1b5afb_entity_0']
[2025-12-29 16:39:46] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:39:46] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:39:46] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:39:46] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:39:46] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:46] INFO amygdala.py:299:   输入 - conversation_text: Second conversation about weather.
[2025-12-29 16:39:46] INFO amygdala.py:300:   输入 - conversation_length: 34 字符
[2025-12-29 16:39:46] INFO particle.py:100: ================================================================================
[2025-12-29 16:39:46] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:39:46] INFO particle.py:102:   输入 - text_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:46] INFO particle.py:103:   输入 - text: Second conversation about weather.
[2025-12-29 16:39:46] INFO particle.py:104:   输入 - text_length: 34 字符
[2025-12-29 16:39:46] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:46] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:39:46] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:39:46] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:46] INFO emotion_v2.py:168:   输入 - text: Second conversation about weather.
[2025-12-29 16:39:46] INFO emotion_v2.py:169:   输入 - text_length: 34 字符
[2025-12-29 16:39:46] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:46] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:39:47] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:39:47] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:39:47] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather']
[2025-12-29 16:39:47] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:39:47] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:39:47] INFO emotion_v2.py:202:   实体列表: ['weather']
[2025-12-29 16:39:47] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:39:50] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: boredom, indifference, apathy
[2025-12-29 16:39:50] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:39:50] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:39:50] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:39:50] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:39:51] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:39:51] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:39:51] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:39:51] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:39:51] INFO emotion_v2.py:277:     1. entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:39:51] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:39:51] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:39:51] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:39:51] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:39:51] INFO particle.py:119:     1. entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:39:51] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:51] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:39:51] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:39:51] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.006526409757002645, 0.01741904041904133, -0.026197318630216074, 0.013820632332476187, 0.0010571752254319468], born=1766997586.4685884
[2025-12-29 16:39:51] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:39:51] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:39:51] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0']
[2025-12-29 16:39:53] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:39:53] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:39:53] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:39:53] INFO amygdala.py:399:   conversation_id: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:53] INFO amygdala.py:400:   对话内容长度: 34 字符
[2025-12-29 16:39:53] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:39:53] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:39:53] INFO amygdala.py:107:   文本 1: Second conversation about weather. (长度: 34 字符)
[2025-12-29 16:39:53] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:39:53] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:39:53] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:39:53] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:39:53] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:39:53] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:53] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:39:53] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:39:53] INFO amygdala.py:428:   对话ID: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:53] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:39:53] INFO amygdala.py:430:   关系映射详情: {'test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0': 'test_conversation-ef8e552773420d95d6d87570033f9f4a'}
[2025-12-29 16:39:54] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:39:54] INFO amygdala.py:442:   对话ID: test_conversation-ef8e552773420d95d6d87570033f9f4a
[2025-12-29 16:39:54] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:39:54] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-ef8e552773420d95d6d87570033f9f4a_entity_0']
[2025-12-29 16:39:54] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:39:54] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:39:54] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:39:54] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:39:54] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:39:54] INFO amygdala.py:299:   输入 - conversation_text: Third conversation about coding.
[2025-12-29 16:39:54] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:39:54] INFO particle.py:100: ================================================================================
[2025-12-29 16:39:54] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:39:54] INFO particle.py:102:   输入 - text_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:39:54] INFO particle.py:103:   输入 - text: Third conversation about coding.
[2025-12-29 16:39:54] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:39:54] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:54] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:39:54] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:39:54] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:39:54] INFO emotion_v2.py:168:   输入 - text: Third conversation about coding.
[2025-12-29 16:39:54] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:39:54] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:39:54] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:39:55] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:39:55] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:39:55] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Third conversation', 'coding']
[2025-12-29 16:39:55] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:39:55] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:39:55] INFO emotion_v2.py:202:   实体列表: ['Third conversation', 'coding']
[2025-12-29 16:39:55] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Third conversation' 生成情感描述
[2025-12-29 16:39:57] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: neutral, curiosity, engagement, anticipation, focus
[2025-12-29 16:39:57] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'coding' 生成情感描述
[2025-12-29 16:39:58] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, curiosity, determination, engagement
[2025-12-29 16:39:58] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:39:58] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:39:58] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:39:58] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:39:59] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:00] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:00] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:40:00] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:40:00] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:40:00] INFO emotion_v2.py:277:     1. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, vector_shape=(2048,)
[2025-12-29 16:40:00] INFO emotion_v2.py:277:     2. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, vector_shape=(2048,)
[2025-12-29 16:40:00] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:40:00] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:00] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:40:00] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:40:00] INFO particle.py:119:     1. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, vector_shape=(2048,)
[2025-12-29 16:40:00] INFO particle.py:119:     2. entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, vector_shape=(2048,)
[2025-12-29 16:40:00] INFO particle.py:201: Successfully created 2 particles for text_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:40:00] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:40:00] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:40:00] INFO amygdala.py:316:   粒子 1/2: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0, entity=Third conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.0027986720899315105, 0.03510350512800326, -0.0146022534692235, 0.015294938491481986, -0.012166683390959776], born=1766997594.3338678
[2025-12-29 16:40:00] INFO amygdala.py:316:   粒子 2/2: entity_id=test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1, entity=coding, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.004231191891800441, 0.02284959941569264, -0.03045061322132038, 0.003349451214348214, -0.01404965264072388], born=1766997594.3338678
[2025-12-29 16:40:00] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:40:00] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:40:00] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0', 'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1']
[2025-12-29 16:40:01] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:40:01] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:40:01] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:40:01] INFO amygdala.py:399:   conversation_id: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:40:01] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:40:01] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:40:01] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:40:01] INFO amygdala.py:107:   文本 1: Third conversation about coding. (长度: 32 字符)
[2025-12-29 16:40:01] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:40:01] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:40:01] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:40:02] INFO amygdala.py:95: Saved 3 conversation records to test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:40:02] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 3
[2025-12-29 16:40:02] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:40:02] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:40:02] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:40:02] INFO amygdala.py:428:   对话ID: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:40:02] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:40:02] INFO amygdala.py:430:   关系映射详情: {'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0': 'test_conversation-f58a5e81158d014f5afd4dc620281fed', 'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1': 'test_conversation-f58a5e81158d014f5afd4dc620281fed'}
[2025-12-29 16:40:03] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:40:03] INFO amygdala.py:442:   对话ID: test_conversation-f58a5e81158d014f5afd4dc620281fed
[2025-12-29 16:40:03] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:40:03] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_0', 'test_conversation-f58a5e81158d014f5afd4dc620281fed_entity_1']
[2025-12-29 16:40:03] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:40:03] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:40:04] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:40:04] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:04] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:40:04] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:40:04] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:04] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:40:04] INFO speed.py:22: Speed module initialized
[2025-12-29 16:40:04] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:40:04] INFO particle.py:79: Particle module initialized
[2025-12-29 16:40:04] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:40:05] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:40:05] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:40:05] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_persistence
[2025-12-29 16:40:05] INFO amygdala.py:70: Loaded 3 conversation records from test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:40:05] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:40:05] INFO amygdala.py:502: Loaded 4 relationship mappings for 3 conversations
[2025-12-29 16:40:05] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:40:05] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:05] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:05] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:40:05] INFO amygdala.py:299:   输入 - conversation_text: New conversation added after reload.
[2025-12-29 16:40:05] INFO amygdala.py:300:   输入 - conversation_length: 36 字符
[2025-12-29 16:40:05] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:05] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:05] INFO particle.py:102:   输入 - text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:40:05] INFO particle.py:103:   输入 - text: New conversation added after reload.
[2025-12-29 16:40:05] INFO particle.py:104:   输入 - text_length: 36 字符
[2025-12-29 16:40:05] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:05] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:05] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:05] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:40:05] INFO emotion_v2.py:168:   输入 - text: New conversation added after reload.
[2025-12-29 16:40:05] INFO emotion_v2.py:169:   输入 - text_length: 36 字符
[2025-12-29 16:40:05] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:05] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:06] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:06] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 0
[2025-12-29 16:40:06] INFO emotion_v2.py:178:   抽取结果 - 实体列表: []
[2025-12-29 16:40:06] WARNING emotion_v2.py:180: [EmotionV2.process] 警告: 未从文本中提取到任何实体
[2025-12-29 16:40:06] WARNING emotion_v2.py:181:   文本内容: New conversation added after reload.
[2025-12-29 16:40:06] WARNING emotion_v2.py:182:   可能原因: 1) 文本中确实没有命名实体 2) 实体提取器无法识别该类型的实体
[2025-12-29 16:40:06] WARNING emotion_v2.py:193: [EmotionV2.process] 处理终止: 没有实体可处理
[2025-12-29 16:40:06] WARNING emotion_v2.py:194:   text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:40:06] WARNING emotion_v2.py:195:   文本内容: New conversation added after reload.
[2025-12-29 16:40:06] WARNING emotion_v2.py:196: ================================================================================
[2025-12-29 16:40:06] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:06] INFO particle.py:115:   提取结果 - emotion_nodes数量: 0
[2025-12-29 16:40:06] WARNING particle.py:134: [Particle.process] 处理终止: 没有情绪节点
[2025-12-29 16:40:06] WARNING particle.py:135:   text_id: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:40:06] WARNING particle.py:136:   文本内容: New conversation added after reload.
[2025-12-29 16:40:06] WARNING particle.py:137:   可能原因: 1) 未提取到实体 2) 情感描述生成失败 3) 情绪嵌入失败
[2025-12-29 16:40:06] WARNING particle.py:138: ================================================================================
[2025-12-29 16:40:06] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 0 个粒子
[2025-12-29 16:40:06] WARNING amygdala.py:328: [Amygdala.add] 警告: 对话 'New conversation added after reload....' 未生成任何粒子
[2025-12-29 16:40:06] WARNING amygdala.py:329:   可能原因: 1) 文本中未提取到实体 2) 实体提取失败 3) 情绪分析失败
[2025-12-29 16:40:06] WARNING amygdala.py:340: [Amygdala.add] 处理完成，但未生成粒子
[2025-12-29 16:40:06] WARNING amygdala.py:341:   对话ID: test_conversation-62feca33840bf086b39df23ee7f043b6
[2025-12-29 16:40:06] WARNING amygdala.py:342:   对话内容: New conversation added after reload.
[2025-12-29 16:40:07] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:40:07] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:07] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:40:07] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:40:07] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:07] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:40:07] INFO speed.py:22: Speed module initialized
[2025-12-29 16:40:07] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:40:07] INFO particle.py:79: Particle module initialized
[2025-12-29 16:40:07] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:40:07] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:40:07] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_persistence, collection=test_particles_persistence
[2025-12-29 16:40:07] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_persistence
[2025-12-29 16:40:07] INFO amygdala.py:70: Loaded 3 conversation records from test_amygdala_persistence/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:40:07] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:40:07] INFO amygdala.py:502: Loaded 4 relationship mappings for 3 conversations
[2025-12-29 16:40:07] INFO amygdala.py:259: Amygdala workflow initialized
Traceback (most recent call last):
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 390, in test_amygdala_persistence
    assert len(new_particles) > 0, "新对话的粒子应该已保存"
AssertionError: 新对话的粒子应该已保存
[2025-12-29 16:40:08] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_custom_id
[2025-12-29 16:40:08] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:40:08] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:08] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:40:08] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:40:08] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:08] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:40:08] INFO speed.py:22: Speed module initialized
[2025-12-29 16:40:08] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:40:08] INFO particle.py:79: Particle module initialized
[2025-12-29 16:40:08] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:40:08] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:40:09] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_custom_id, collection=test_particles_custom_id
[2025-12-29 16:40:09] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_custom_id, collection=test_particles_custom_id
[2025-12-29 16:40:09] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_custom_id
[2025-12-29 16:40:09] INFO amygdala.py:39: Creating working directory: test_amygdala_custom_id/conversation_embeddings
[2025-12-29 16:40:09] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:40:09] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:40:09] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:40:09] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:09] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:09] INFO amygdala.py:298:   输入 - conversation_id: custom_conversation_001
[2025-12-29 16:40:09] INFO amygdala.py:299:   输入 - conversation_text: This is a test conversation.
[2025-12-29 16:40:09] INFO amygdala.py:300:   输入 - conversation_length: 28 字符
[2025-12-29 16:40:09] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:09] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:09] INFO particle.py:102:   输入 - text_id: custom_conversation_001
[2025-12-29 16:40:09] INFO particle.py:103:   输入 - text: This is a test conversation.
[2025-12-29 16:40:09] INFO particle.py:104:   输入 - text_length: 28 字符
[2025-12-29 16:40:09] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:09] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:09] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:09] INFO emotion_v2.py:167:   输入 - text_id: custom_conversation_001
[2025-12-29 16:40:09] INFO emotion_v2.py:168:   输入 - text: This is a test conversation.
[2025-12-29 16:40:09] INFO emotion_v2.py:169:   输入 - text_length: 28 字符
[2025-12-29 16:40:09] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:09] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:09] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:09] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:40:09] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['test', 'conversation']
[2025-12-29 16:40:09] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:40:09] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:40:09] INFO emotion_v2.py:202:   实体列表: ['test', 'conversation']
[2025-12-29 16:40:09] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'test' 生成情感描述
[2025-12-29 16:40:14] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: anticipation, curiosity, neutrality, focus, readiness
[2025-12-29 16:40:14] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:40:16] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: neutral
[2025-12-29 16:40:16] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:40:16] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:40:16] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:40:16] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:40:16] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=custom_conversation_001_entity_0, entity=test, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:17] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=custom_conversation_001_entity_1, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:17] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:40:17] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:40:17] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:40:17] INFO emotion_v2.py:277:     1. entity_id=custom_conversation_001_entity_0, entity=test, vector_shape=(2048,)
[2025-12-29 16:40:17] INFO emotion_v2.py:277:     2. entity_id=custom_conversation_001_entity_1, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:40:17] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:40:17] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:17] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:40:17] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:40:17] INFO particle.py:119:     1. entity_id=custom_conversation_001_entity_0, entity=test, vector_shape=(2048,)
[2025-12-29 16:40:17] INFO particle.py:119:     2. entity_id=custom_conversation_001_entity_1, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:40:17] INFO particle.py:201: Successfully created 2 particles for text_id: custom_conversation_001
[2025-12-29 16:40:17] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:40:17] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:40:17] INFO amygdala.py:316:   粒子 1/2: entity_id=custom_conversation_001_entity_0, entity=test, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.01200962599156612, 0.03564570997496744, -0.02015471498584615, 0.005966495995809968, -0.01877530498681485], born=1766997609.4026682
[2025-12-29 16:40:17] INFO amygdala.py:316:   粒子 2/2: entity_id=custom_conversation_001_entity_1, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.01897679327594863, 0.0327855354767467, 0.0017874782259923877, 0.022145437322025067, -0.017924475260646482], born=1766997609.4026682
[2025-12-29 16:40:17] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:40:17] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:40:17] INFO amygdala.py:380:   粒子ID列表: ['custom_conversation_001_entity_0', 'custom_conversation_001_entity_1']
[2025-12-29 16:40:17] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:40:17] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:40:17] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:40:17] INFO amygdala.py:399:   conversation_id: custom_conversation_001
[2025-12-29 16:40:17] INFO amygdala.py:400:   对话内容长度: 28 字符
[2025-12-29 16:40:17] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:40:17] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:40:17] INFO amygdala.py:107:   文本 1: This is a test conversation. (长度: 28 字符)
[2025-12-29 16:40:17] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:40:17] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:40:17] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:40:17] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_custom_id/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:40:17] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:40:17] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=custom_conversation_001
[2025-12-29 16:40:17] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:40:17] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:40:17] INFO amygdala.py:428:   对话ID: custom_conversation_001
[2025-12-29 16:40:17] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:40:17] INFO amygdala.py:430:   关系映射详情: {'custom_conversation_001_entity_0': 'custom_conversation_001', 'custom_conversation_001_entity_1': 'custom_conversation_001'}
[2025-12-29 16:40:17] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:40:17] INFO amygdala.py:442:   对话ID: custom_conversation_001
[2025-12-29 16:40:17] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:40:17] INFO amygdala.py:444:   粒子ID列表: ['custom_conversation_001_entity_0', 'custom_conversation_001_entity_1']
[2025-12-29 16:40:17] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:40:17] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:40:18] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_linking
[2025-12-29 16:40:18] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:40:18] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:18] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:40:18] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:40:18] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:18] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:40:18] INFO speed.py:22: Speed module initialized
[2025-12-29 16:40:18] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:40:18] INFO particle.py:79: Particle module initialized
[2025-12-29 16:40:18] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:40:18] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:40:18] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_linking, collection=test_particles_linking
[2025-12-29 16:40:18] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_linking, collection=test_particles_linking
[2025-12-29 16:40:18] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_linking
[2025-12-29 16:40:18] INFO amygdala.py:39: Creating working directory: test_amygdala_linking/conversation_embeddings
[2025-12-29 16:40:18] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:40:18] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:40:18] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:40:18] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:18] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:18] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:18] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming and machine learning!
[2025-12-29 16:40:18] INFO amygdala.py:300:   输入 - conversation_length: 47 字符
[2025-12-29 16:40:18] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:18] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:18] INFO particle.py:102:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:18] INFO particle.py:103:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:40:18] INFO particle.py:104:   输入 - text_length: 47 字符
[2025-12-29 16:40:18] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:18] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:18] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:18] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:18] INFO emotion_v2.py:168:   输入 - text: I love Python programming and machine learning!
[2025-12-29 16:40:18] INFO emotion_v2.py:169:   输入 - text_length: 47 字符
[2025-12-29 16:40:18] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:18] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:18] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:18] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:40:18] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:40:18] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:40:18] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:40:18] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming', 'machine learning']
[2025-12-29 16:40:18] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:40:24] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, admiration, enthusiasm, excitement
[2025-12-29 16:40:24] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:40:30] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, passion, excitement, admiration, enthusiasm, satisfaction
[2025-12-29 16:40:30] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'machine learning' 生成情感描述
[2025-12-29 16:40:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, enthusiasm
[2025-12-29 16:40:32] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:40:32] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:40:32] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:40:32] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:40:33] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:33] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:34] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:34] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:40:34] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:40:34] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:40:34] INFO emotion_v2.py:277:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:40:34] INFO emotion_v2.py:277:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:40:34] INFO emotion_v2.py:277:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:40:34] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:40:34] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:34] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:40:34] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:40:34] INFO particle.py:119:     1. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:40:34] INFO particle.py:119:     2. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:40:34] INFO particle.py:119:     3. entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, vector_shape=(2048,)
[2025-12-29 16:40:34] INFO particle.py:201: Successfully created 3 particles for text_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:34] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:40:34] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:40:35] INFO amygdala.py:316:   粒子 1/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.012364232002540769, 0.01297140400266554, -0.023160856004759405, 0.007749724001592518, -0.004912574301009502], born=1766997618.9253721
[2025-12-29 16:40:35] INFO amygdala.py:316:   粒子 2/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016981116347052537, 0.004608526222795778, -0.024889369042969258, 0.015716682395671772, -0.0005261539297686521], born=1766997618.9253721
[2025-12-29 16:40:35] INFO amygdala.py:316:   粒子 3/3: entity_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2, entity=machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.016803517936497536, 0.01231359995346546, -0.031923315879358045, 0.007413976971981712, -0.010472733460422311], born=1766997618.9253721
[2025-12-29 16:40:35] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:40:35] INFO amygdala.py:355:   参数: distance_threshold=1.5, top_k=5
[2025-12-29 16:40:35] INFO linking.py:72: Building hyperbolic links for 3 entities (threshold=1.5, top_k=5)
[2025-12-29 16:40:35] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:40:35] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:40:35] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:40:35] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:40:35] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:40:39] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:40:39] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:40:39] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:40:39] INFO amygdala.py:399:   conversation_id: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:39] INFO amygdala.py:400:   对话内容长度: 47 字符
[2025-12-29 16:40:39] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:40:39] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:40:39] INFO amygdala.py:107:   文本 1: I love Python programming and machine learning! (长度: 47 字符)
[2025-12-29 16:40:39] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:40:39] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:40:39] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:40:40] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_linking/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:40:40] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:40:40] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:40] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:40:40] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:40:40] INFO amygdala.py:428:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:40] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:40:40] INFO amygdala.py:430:   关系映射详情: {'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2': 'test_conversation-d92876fdc0ca1ac61d775e496574e00e'}
[2025-12-29 16:40:40] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:40:40] INFO amygdala.py:442:   对话ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
[2025-12-29 16:40:40] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:40:40] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_0', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_1', 'test_conversation-d92876fdc0ca1ac61d775e496574e00e_entity_2']
[2025-12-29 16:40:40] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:40:40] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:40:40] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_edge
[2025-12-29 16:40:41] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:40:41] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:41] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:40:41] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:40:41] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:40:41] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:40:41] INFO speed.py:22: Speed module initialized
[2025-12-29 16:40:41] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:40:41] INFO particle.py:79: Particle module initialized
[2025-12-29 16:40:41] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:40:41] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:40:43] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_edge, collection=test_particles_edge
[2025-12-29 16:40:43] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_edge, collection=test_particles_edge
[2025-12-29 16:40:43] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_edge
[2025-12-29 16:40:43] INFO amygdala.py:39: Creating working directory: test_amygdala_edge/conversation_embeddings
[2025-12-29 16:40:43] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:40:43] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:40:43] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:40:43] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:43] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:43] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:40:43] INFO amygdala.py:299:   输入 - conversation_text: 
[2025-12-29 16:40:43] INFO amygdala.py:300:   输入 - conversation_length: 0 字符
[2025-12-29 16:40:43] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:43] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:43] INFO particle.py:102:   输入 - text_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:40:43] INFO particle.py:103:   输入 - text: 
[2025-12-29 16:40:43] INFO particle.py:104:   输入 - text_length: 0 字符
[2025-12-29 16:40:43] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:43] WARNING emotion_v2.py:157: ================================================================================
[2025-12-29 16:40:43] WARNING emotion_v2.py:158: [EmotionV2.process] 输入文本为空，跳过处理
[2025-12-29 16:40:43] WARNING emotion_v2.py:159:   text_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:40:43] WARNING emotion_v2.py:160:   text_length: 0 字符
[2025-12-29 16:40:43] WARNING emotion_v2.py:161: ================================================================================
[2025-12-29 16:40:43] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:43] INFO particle.py:115:   提取结果 - emotion_nodes数量: 0
[2025-12-29 16:40:43] WARNING particle.py:134: [Particle.process] 处理终止: 没有情绪节点
[2025-12-29 16:40:43] WARNING particle.py:135:   text_id: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:40:43] WARNING particle.py:136:   文本内容: 
[2025-12-29 16:40:43] WARNING particle.py:137:   可能原因: 1) 未提取到实体 2) 情感描述生成失败 3) 情绪嵌入失败
[2025-12-29 16:40:43] WARNING particle.py:138: ================================================================================
[2025-12-29 16:40:43] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 0 个粒子
[2025-12-29 16:40:43] WARNING amygdala.py:328: [Amygdala.add] 警告: 对话 '...' 未生成任何粒子
[2025-12-29 16:40:43] WARNING amygdala.py:329:   可能原因: 1) 文本中未提取到实体 2) 实体提取失败 3) 情绪分析失败
[2025-12-29 16:40:43] WARNING amygdala.py:340: [Amygdala.add] 处理完成，但未生成粒子
[2025-12-29 16:40:43] WARNING amygdala.py:341:   对话ID: test_conversation-d41d8cd98f00b204e9800998ecf8427e
[2025-12-29 16:40:43] WARNING amygdala.py:342:   对话内容: 
[2025-12-29 16:40:43] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:43] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:43] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:43] INFO amygdala.py:299:   输入 - conversation_text: This is a repeated conversation.
[2025-12-29 16:40:43] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:40:43] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:43] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:43] INFO particle.py:102:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:43] INFO particle.py:103:   输入 - text: This is a repeated conversation.
[2025-12-29 16:40:43] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:40:43] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:43] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:43] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:43] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:43] INFO emotion_v2.py:168:   输入 - text: This is a repeated conversation.
[2025-12-29 16:40:43] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:40:43] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:43] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:44] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:44] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:40:44] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['conversation']
[2025-12-29 16:40:44] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:40:44] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:40:44] INFO emotion_v2.py:202:   实体列表: ['conversation']
[2025-12-29 16:40:44] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:40:46] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: boredom, frustration, weariness, impatience
[2025-12-29 16:40:46] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:40:46] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:40:46] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:40:46] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:40:47] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:47] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:40:47] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:40:47] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:40:47] INFO emotion_v2.py:277:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:40:47] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:40:47] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:47] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:40:47] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:40:47] INFO particle.py:119:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:40:47] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:47] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:40:47] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:40:47] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.004292286095778619, 0.014799778330244139, -0.03758303083863254, 0.036672637818317914, -0.011251566251068882], born=1766997643.8048286
[2025-12-29 16:40:47] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:40:47] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:40:47] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:40:49] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:40:49] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:40:49] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:40:49] INFO amygdala.py:399:   conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:49] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:40:49] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:40:49] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:40:49] INFO amygdala.py:107:   文本 1: This is a repeated conversation. (长度: 32 字符)
[2025-12-29 16:40:49] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:40:49] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:40:49] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:40:49] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_edge/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:40:49] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:40:49] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:49] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:40:49] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:40:49] INFO amygdala.py:428:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:49] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:40:49] INFO amygdala.py:430:   关系映射详情: {'test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0': 'test_conversation-67761e24aa41439e9fd7a98cf1968b90'}
[2025-12-29 16:40:49] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:40:49] INFO amygdala.py:442:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:49] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:40:49] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:40:49] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:40:49] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:40:49] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:50] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:50] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:50] INFO amygdala.py:299:   输入 - conversation_text: This is a repeated conversation.
[2025-12-29 16:40:50] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:40:50] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:50] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:50] INFO particle.py:102:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:50] INFO particle.py:103:   输入 - text: This is a repeated conversation.
[2025-12-29 16:40:50] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:40:50] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:50] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:50] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:50] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:50] INFO emotion_v2.py:168:   输入 - text: This is a repeated conversation.
[2025-12-29 16:40:50] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:40:50] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:50] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:50] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:50] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:40:50] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['conversation']
[2025-12-29 16:40:50] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:40:50] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:40:50] INFO emotion_v2.py:202:   实体列表: ['conversation']
[2025-12-29 16:40:50] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:40:53] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: frustration, weariness, boredom, impatience, disappointment
[2025-12-29 16:40:53] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:40:53] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:40:53] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:40:53] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:40:53] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:40:53] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:40:53] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:40:53] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:40:53] INFO emotion_v2.py:277:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:40:53] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:40:53] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:53] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:40:53] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:40:53] INFO particle.py:119:     1. entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:40:53] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:53] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:40:53] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:40:53] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.004319202160286709, 0.01791581566486055, -0.03878998943950653, 0.038103649414036274, -0.012271268455389943], born=1766997650.02965
[2025-12-29 16:40:53] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:40:53] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:40:53] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:40:54] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:40:54] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:40:54] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:40:54] INFO amygdala.py:399:   conversation_id: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:54] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:40:54] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:40:54] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:40:54] INFO amygdala.py:107:   文本 1: This is a repeated conversation. (长度: 32 字符)
[2025-12-29 16:40:54] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 0 条新记录, 1 条已存在
[2025-12-29 16:40:54] INFO amygdala.py:131: [SimpleConversationStore.insert_strings] 所有文本已存在，跳过插入
[2025-12-29 16:40:54] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:54] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:40:54] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:40:54] INFO amygdala.py:428:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:54] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:40:54] INFO amygdala.py:430:   关系映射详情: {'test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0': 'test_conversation-67761e24aa41439e9fd7a98cf1968b90'}
[2025-12-29 16:40:54] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:40:54] INFO amygdala.py:442:   对话ID: test_conversation-67761e24aa41439e9fd7a98cf1968b90
[2025-12-29 16:40:54] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:40:54] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-67761e24aa41439e9fd7a98cf1968b90_entity_0']
[2025-12-29 16:40:54] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:40:54] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:40:54] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:54] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:54] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] INFO amygdala.py:299:   输入 - conversation_text: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:40:54] INFO amygdala.py:300:   输入 - conversation_length: 44 字符
[2025-12-29 16:40:54] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:54] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:54] INFO particle.py:102:   输入 - text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] INFO particle.py:103:   输入 - text: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:40:54] INFO particle.py:104:   输入 - text_length: 44 字符
[2025-12-29 16:40:54] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:54] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:54] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:54] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] INFO emotion_v2.py:168:   输入 - text: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:40:54] INFO emotion_v2.py:169:   输入 - text_length: 44 字符
[2025-12-29 16:40:54] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:54] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:54] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:54] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 0
[2025-12-29 16:40:54] INFO emotion_v2.py:178:   抽取结果 - 实体列表: []
[2025-12-29 16:40:54] WARNING emotion_v2.py:180: [EmotionV2.process] 警告: 未从文本中提取到任何实体
[2025-12-29 16:40:54] WARNING emotion_v2.py:181:   文本内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:40:54] WARNING emotion_v2.py:182:   可能原因: 1) 文本中确实没有命名实体 2) 实体提取器无法识别该类型的实体
[2025-12-29 16:40:54] WARNING emotion_v2.py:193: [EmotionV2.process] 处理终止: 没有实体可处理
[2025-12-29 16:40:54] WARNING emotion_v2.py:194:   text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] WARNING emotion_v2.py:195:   文本内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:40:54] WARNING emotion_v2.py:196: ================================================================================
[2025-12-29 16:40:54] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:40:54] INFO particle.py:115:   提取结果 - emotion_nodes数量: 0
[2025-12-29 16:40:54] WARNING particle.py:134: [Particle.process] 处理终止: 没有情绪节点
[2025-12-29 16:40:54] WARNING particle.py:135:   text_id: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] WARNING particle.py:136:   文本内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?
[2025-12-29 16:40:54] WARNING particle.py:137:   可能原因: 1) 未提取到实体 2) 情感描述生成失败 3) 情绪嵌入失败
[2025-12-29 16:40:54] WARNING particle.py:138: ================================================================================
[2025-12-29 16:40:54] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 0 个粒子
[2025-12-29 16:40:54] WARNING amygdala.py:328: [Amygdala.add] 警告: 对话 'Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?...' 未生成任何粒子
[2025-12-29 16:40:54] WARNING amygdala.py:329:   可能原因: 1) 文本中未提取到实体 2) 实体提取失败 3) 情绪分析失败
[2025-12-29 16:40:54] WARNING amygdala.py:340: [Amygdala.add] 处理完成，但未生成粒子
[2025-12-29 16:40:54] WARNING amygdala.py:341:   对话ID: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] WARNING amygdala.py:342:   对话内容: Special chars: !@#$%^&*()_+-=[]{}|;':",./<>?

====================================================================================================
Amygdala 工作流类 - 全方位测试
====================================================================================================
====================================================================================================
测试1：基本功能测试
====================================================================================================

【Step 1】初始化 Amygdala...
✓ Amygdala 初始化成功
  - 工作目录: ./test_amygdala_basic
  - 粒子集合: test_particles_basic
  - 对话命名空间: test_conversation

【Step 2】添加对话...
对话内容: I love Python programming and I'm excited about machine learning!

✓ 对话处理成功
  - 对话 ID: test_conversation-a303c4404f2ed0d8ad548c735f18a136
  - 生成粒子数: 3
  - 关系映射数: 3

【Step 3】验证粒子信息...
✓ 成功生成 3 个粒子:
  1. test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0: Python
     速度: 0.5000, 温度: 0.5000, 质量: 1.0000
  2. test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1: programming
     速度: 0.5000, 温度: 0.5000, 质量: 1.0000
  3. test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2: machine learning
     速度: 0.5000, 温度: 0.5000, 质量: 1.0000

【Step 4】验证关系映射...
✓ 关系映射包含 3 条记录
  test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_0 -> test_conversation-a303c4404f2ed0d8ad548c735f18a136
  test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_1 -> test_conversation-a303c4404f2ed0d8ad548c735f18a136
  test_conversation-a303c4404f2ed0d8ad548c735f18a136_entity_2 -> test_conversation-a303c4404f2ed0d8ad548c735f18a136

====================================================================================================
✓ 测试1完成：基本功能正常
====================================================================================================

✓ 基本功能 测试通过

====================================================================================================
测试2：多个对话测试
====================================================================================================

【Step 1】初始化 Amygdala...
✓ 初始化成功

【Step 2】添加多个对话...

添加对话 1: I love Python programming and machine learning!...
  ✓ 对话 ID: test_conversation-d92876fdc0ca1ac61d775e496574e00e
  ✓ 生成粒子数: 3

添加对话 2: The weather is beautiful today, I feel happy....
  ✓ 对话 ID: test_conversation-83524becd2b7394577cc4ea2e2f8d724
  ✓ 生成粒子数: 3

添加对话 3: I'm frustrated with this bug in my code....
  ✓ 对话 ID: test_conversation-028403027411873a0426c8a1906d39af
  ✓ 生成粒子数: 3

添加对话 4: Learning new technologies is exciting and challeng...
  ✓ 对话 ID: test_conversation-e05db879cb2c698162903b78288164db
  ✓ 生成粒子数: 4

【Step 3】验证所有对话处理结果...
✓ 总共处理了 4 个对话
✓ 总共生成了 13 个粒子

【Step 4】验证关系映射...
✓ 验证了 13 个粒子的映射关系
✓ 涉及 4 个对话

【Step 5】验证反向映射...
  对话 test_conversation-02... 包含 3 个粒子
  对话 test_conversation-e0... 包含 4 个粒子
  对话 test_conversation-d9... 包含 3 个粒子
  对话 test_conversation-83... 包含 3 个粒子

====================================================================================================
✓ 测试2完成：多个对话处理正常
====================================================================================================

✓ 多个对话 测试通过

====================================================================================================
测试3：关系映射功能测试
====================================================================================================

【Step 1】初始化并添加对话...
✓ 添加了 2 个对话
  对话1 ID: test_conversation-5eb80fe0f860cf85f98cd1626aa74bd2
  对话2 ID: test_conversation-042bc3ca359baf149ebbe296e0f5adfb

【Step 2】测试 get_conversation_by_particle...
  粒子 test_conversation-5e... -> 对话 test_conversation-5e...
  ✓ 映射关系正确

【Step 3】测试 get_particles_by_conversation...
  对话1包含 2 个粒子
  对话2包含 3 个粒子
  ✓ 粒子列表正确

【Step 4】测试 get_conversation_text...
  对话1文本: I love Python programming!...
  ✓ 对话文本正确
  对话2文本: The weather is beautiful today....
  ✓ 对话文本正确

【Step 5】测试边界情况...
  ✓ 不存在的粒子返回 None
  ✓ 不存在的对话返回空列表

====================================================================================================
✓ 测试3完成：关系映射功能正常
====================================================================================================

✓ 关系映射 测试通过

====================================================================================================
测试4：持久化测试
====================================================================================================

【Step 1】创建第一个 Amygdala 实例并添加数据...
✓ 添加了 3 个对话
✓ 生成了 4 个粒子
✓ 记录了 4 条映射关系

【Step 2】创建第二个 Amygdala 实例（加载已有数据）...

【Step 3】验证数据已加载...
  加载的映射关系数: 4
  原始映射关系数: 4
  ✓ 所有映射关系一致

【Step 4】添加新对话并验证持久化...

❌ 测试4失败: 新对话的粒子应该已保存

❌ 持久化 测试失败: 新对话的粒子应该已保存

====================================================================================================
测试5：自定义对话 ID 测试
====================================================================================================

【Step 1】初始化 Amygdala...

【Step 2】使用自定义 ID 添加对话...
  提供的 ID: custom_conversation_001
  返回的 ID: custom_conversation_001
  ✓ 自定义 ID 正确使用

【Step 3】验证自定义 ID 查询...
  查询到的粒子数: 2
  查询到的文本: None...
  ✓ 自定义 ID 查询正常

====================================================================================================
✓ 测试5完成：自定义对话 ID 功能正常
====================================================================================================

✓ 自定义ID 测试通过

====================================================================================================
测试6：自动链接功能测试
====================================================================================================

【Step 1】初始化 Amygdala（启用自动链接）...
✓ 初始化成功，自动链接已启用

【Step 2】添加对话...
✓ 添加了对话，生成了 3 个粒子

【Step 3】验证粒子链接...
  ✓ 生成了 3 个粒子，链接应该已构建
  （链接信息存储在粒子的 metadata 中）

====================================================================================================
✓ 测试6完成：自动链接功能正常
====================================================================================================

✓ 自动链接 测试通过

====================================================================================================
测试7：边界情况测试
====================================================================================================

【Step 1】初始化 Amygdala...

【Step 2】测试空对话...
  空对话结果: 0 个粒子
  ✓ 空对话处理正确

【Step 3】测试重复对话...
  第一次添加: test_conversation-67761e24aa41439e9fd7a98cf1968b90
  第二次添加: test_conversation-67761e24aa41439e9fd7a98cf1968b90
  ✓ 重复对话处理正确（生成相同 ID）

【Step 4】测试特殊字符...
  ✓ 特殊字符对话处理成功: test_conversation-18cfb2b78510d7e62ce89e0c72720d67
[2025-12-29 16:40:54] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:40:54] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:40:54] INFO amygdala.py:298:   输入 - conversation_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:40:54] INFO amygdala.py:299:   输入 - conversation_text: This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversati...
[2025-12-29 16:40:54] INFO amygdala.py:300:   输入 - conversation_length: 3400 字符
[2025-12-29 16:40:54] INFO particle.py:100: ================================================================================
[2025-12-29 16:40:54] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:40:54] INFO particle.py:102:   输入 - text_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:40:54] INFO particle.py:103:   输入 - text: This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversati...
[2025-12-29 16:40:54] INFO particle.py:104:   输入 - text_length: 3400 字符
[2025-12-29 16:40:54] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:54] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:40:54] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:40:54] INFO emotion_v2.py:167:   输入 - text_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:40:54] INFO emotion_v2.py:168:   输入 - text: This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversation. This is a very long conversati...
[2025-12-29 16:40:54] INFO emotion_v2.py:169:   输入 - text_length: 3400 字符
[2025-12-29 16:40:54] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:40:54] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:40:54] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:40:54] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:40:54] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['conversation']
[2025-12-29 16:40:54] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:40:54] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:40:54] INFO emotion_v2.py:202:   实体列表: ['conversation']
[2025-12-29 16:40:54] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'conversation' 生成情感描述
[2025-12-29 16:41:00] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: boredom, frustration, weariness, impatience
[2025-12-29 16:41:00] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:41:00] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:41:00] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:41:00] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:41:01] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:01] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:41:01] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:41:01] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:41:01] INFO emotion_v2.py:277:     1. entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:41:01] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:41:01] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:41:01] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:41:01] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:41:01] INFO particle.py:119:     1. entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, vector_shape=(2048,)
[2025-12-29 16:41:01] INFO particle.py:201: Successfully created 1 particles for text_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:41:01] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:41:01] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:41:01] INFO amygdala.py:316:   粒子 1/1: entity_id=test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0, entity=conversation, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.004292286095778619, 0.014799778330244139, -0.03758303083863254, 0.036672637818317914, -0.011251566251068882], born=1766997654.529351
[2025-12-29 16:41:01] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:41:01] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:41:01] INFO amygdala.py:380:   粒子ID列表: ['test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0']
[2025-12-29 16:41:04] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:41:04] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:41:04] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:41:04] INFO amygdala.py:399:   conversation_id: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:41:04] INFO amygdala.py:400:   对话内容长度: 3400 字符
[2025-12-29 16:41:04] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:41:04] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:41:04] INFO amygdala.py:107:   文本 1: This is a very long conversation. This is a very long conversation. This is a very long conversation... (长度: 3400 字符)
[2025-12-29 16:41:04] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:41:04] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:41:04] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:41:04] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_edge/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:41:04] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:41:04] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:41:04] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:41:04] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:41:04] INFO amygdala.py:428:   对话ID: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:41:04] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:41:04] INFO amygdala.py:430:   关系映射详情: {'test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0': 'test_conversation-c71799e88f5e10295ff92584914c2d52'}
[2025-12-29 16:41:05] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:41:05] INFO amygdala.py:442:   对话ID: test_conversation-c71799e88f5e10295ff92584914c2d52
[2025-12-29 16:41:05] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:41:05] INFO amygdala.py:444:   粒子ID列表: ['test_conversation-c71799e88f5e10295ff92584914c2d52_entity_0']
[2025-12-29 16:41:05] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:41:05] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:41:05] INFO test_amygdala.py:33: 清理测试数据: ./test_amygdala_integration
[2025-12-29 16:41:06] INFO prompt_template_manager.py:58: Loading templates from directory: /mnt/d/Codes/HyperAmy/hipporag/prompts/templates
[2025-12-29 16:41:06] INFO entitiy.py:61: Entity initialized with model: DeepSeek-V3.2
[2025-12-29 16:41:06] INFO prompt_template_manager.py:51: Loading templates from directory: /mnt/d/Codes/HyperAmy/prompts/templates
[2025-12-29 16:41:07] WARNING prompt_template_manager.py:63: Module 'ner_improved' does not define a 'prompt_template'. Skipping.
[2025-12-29 16:41:07] INFO sentence.py:43: Sentence initialized with model: DeepSeek-V3.2
[2025-12-29 16:41:07] INFO emotion_v2.py:84: EmotionV2 initialized with model: DeepSeek-V3.2, embedding_model: GLM-Embedding-3
[2025-12-29 16:41:07] INFO speed.py:22: Speed module initialized
[2025-12-29 16:41:07] INFO temperature.py:22: Temperature module initialized
[2025-12-29 16:41:07] INFO particle.py:79: Particle module initialized
[2025-12-29 16:41:07] INFO amygdala.py:221: Particle module initialized
[2025-12-29 16:41:07] INFO posthog.py:22: Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
[2025-12-29 16:41:08] INFO chroma_client.py:36: ChromaClient initialized: path=./hyperamy_db_test_particles_integration, collection=test_particles_integration
[2025-12-29 16:41:08] INFO storage.py:37: HyperAmyStorage initialized: path=./hyperamy_db_test_particles_integration, collection=test_particles_integration
[2025-12-29 16:41:08] INFO amygdala.py:227: Particle storage initialized: collection=test_particles_integration
[2025-12-29 16:41:08] INFO amygdala.py:39: Creating working directory: test_amygdala_integration/conversation_embeddings
[2025-12-29 16:41:08] INFO amygdala.py:251: Conversation store initialized without embedding model
[2025-12-29 16:41:08] INFO amygdala.py:485: No existing relationship mapping file found
[2025-12-29 16:41:08] INFO amygdala.py:259: Amygdala workflow initialized
[2025-12-29 16:41:08] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:41:08] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:41:08] INFO amygdala.py:298:   输入 - conversation_id: conv_001
[2025-12-29 16:41:08] INFO amygdala.py:299:   输入 - conversation_text: I love Python programming!
[2025-12-29 16:41:08] INFO amygdala.py:300:   输入 - conversation_length: 26 字符
[2025-12-29 16:41:08] INFO particle.py:100: ================================================================================
[2025-12-29 16:41:08] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:41:08] INFO particle.py:102:   输入 - text_id: conv_001
[2025-12-29 16:41:08] INFO particle.py:103:   输入 - text: I love Python programming!
[2025-12-29 16:41:08] INFO particle.py:104:   输入 - text_length: 26 字符
[2025-12-29 16:41:08] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:08] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:41:08] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:41:08] INFO emotion_v2.py:167:   输入 - text_id: conv_001
[2025-12-29 16:41:08] INFO emotion_v2.py:168:   输入 - text: I love Python programming!
[2025-12-29 16:41:08] INFO emotion_v2.py:169:   输入 - text_length: 26 字符
[2025-12-29 16:41:08] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:08] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:41:09] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:41:09] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 2
[2025-12-29 16:41:09] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Python', 'programming']
[2025-12-29 16:41:09] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:41:09] INFO emotion_v2.py:201:   实体数量: 2
[2025-12-29 16:41:09] INFO emotion_v2.py:202:   实体列表: ['Python', 'programming']
[2025-12-29 16:41:09] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Python' 生成情感描述
[2025-12-29 16:41:11] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: love, joy, admiration, enthusiasm
[2025-12-29 16:41:11] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'programming' 生成情感描述
[2025-12-29 16:41:13] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: love, joy, enthusiasm, satisfaction
[2025-12-29 16:41:13] INFO sentence.py:120: Generated 2 affective descriptions for 2 entities
[2025-12-29 16:41:13] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:41:13] INFO emotion_v2.py:210:   成功生成: 2/2 个描述
[2025-12-29 16:41:13] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:41:14] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_001_entity_0, entity=Python, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:14] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_001_entity_1, entity=programming, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:14] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:41:14] INFO emotion_v2.py:274:   成功处理: 2/2 个实体
[2025-12-29 16:41:14] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:41:14] INFO emotion_v2.py:277:     1. entity_id=conv_001_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:41:14] INFO emotion_v2.py:277:     2. entity_id=conv_001_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:41:14] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:41:14] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:41:14] INFO particle.py:115:   提取结果 - emotion_nodes数量: 2
[2025-12-29 16:41:14] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:41:15] INFO particle.py:119:     1. entity_id=conv_001_entity_0, entity=Python, vector_shape=(2048,)
[2025-12-29 16:41:15] INFO particle.py:119:     2. entity_id=conv_001_entity_1, entity=programming, vector_shape=(2048,)
[2025-12-29 16:41:15] INFO particle.py:201: Successfully created 2 particles for text_id: conv_001
[2025-12-29 16:41:15] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 2 个粒子
[2025-12-29 16:41:15] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:41:15] INFO amygdala.py:316:   粒子 1/2: entity_id=conv_001_entity_0, entity=Python, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.022698310300948186, 0.004945071247704037, -0.03886854880294484, 0.010426459678890831, -0.005524639329854774], born=1766997668.7764153
[2025-12-29 16:41:15] INFO amygdala.py:316:   粒子 2/2: entity_id=conv_001_entity_1, entity=programming, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02075335263620337, 0.006544842200635086, -0.03628938111246732, 0.019837422608125124, -0.007066574216629015], born=1766997668.7764153
[2025-12-29 16:41:15] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:41:15] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:41:15] INFO linking.py:72: Building hyperbolic links for 2 entities (threshold=2.0, top_k=10)
[2025-12-29 16:41:15] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:41:15] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:41:15] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:41:15] INFO amygdala.py:378:   粒子数量: 2
[2025-12-29 16:41:15] INFO amygdala.py:380:   粒子ID列表: ['conv_001_entity_0', 'conv_001_entity_1']
[2025-12-29 16:41:20] INFO storage.py:128: Batch upserted 2 entities
[2025-12-29 16:41:20] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 2 个粒子已存储到数据库
[2025-12-29 16:41:20] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:41:20] INFO amygdala.py:399:   conversation_id: conv_001
[2025-12-29 16:41:20] INFO amygdala.py:400:   对话内容长度: 26 字符
[2025-12-29 16:41:20] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:41:20] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:41:20] INFO amygdala.py:107:   文本 1: I love Python programming! (长度: 26 字符)
[2025-12-29 16:41:20] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:41:20] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:41:20] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:41:21] INFO amygdala.py:95: Saved 1 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:41:21] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 1
[2025-12-29 16:41:21] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_001
[2025-12-29 16:41:21] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:41:21] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:41:21] INFO amygdala.py:428:   对话ID: conv_001
[2025-12-29 16:41:21] INFO amygdala.py:429:   关联粒子数: 2
[2025-12-29 16:41:21] INFO amygdala.py:430:   关系映射详情: {'conv_001_entity_0': 'conv_001', 'conv_001_entity_1': 'conv_001'}
[2025-12-29 16:41:21] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:41:21] INFO amygdala.py:442:   对话ID: conv_001
[2025-12-29 16:41:21] INFO amygdala.py:443:   生成粒子数: 2
[2025-12-29 16:41:21] INFO amygdala.py:444:   粒子ID列表: ['conv_001_entity_0', 'conv_001_entity_1']
[2025-12-29 16:41:21] INFO amygdala.py:445:   关系映射数: 2
[2025-12-29 16:41:21] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:41:21] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:41:21] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:41:21] INFO amygdala.py:298:   输入 - conversation_id: conv_002
[2025-12-29 16:41:21] INFO amygdala.py:299:   输入 - conversation_text: The weather is beautiful today.
[2025-12-29 16:41:21] INFO amygdala.py:300:   输入 - conversation_length: 31 字符
[2025-12-29 16:41:21] INFO particle.py:100: ================================================================================
[2025-12-29 16:41:21] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:41:21] INFO particle.py:102:   输入 - text_id: conv_002
[2025-12-29 16:41:21] INFO particle.py:103:   输入 - text: The weather is beautiful today.
[2025-12-29 16:41:21] INFO particle.py:104:   输入 - text_length: 31 字符
[2025-12-29 16:41:21] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:21] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:41:21] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:41:21] INFO emotion_v2.py:167:   输入 - text_id: conv_002
[2025-12-29 16:41:21] INFO emotion_v2.py:168:   输入 - text: The weather is beautiful today.
[2025-12-29 16:41:21] INFO emotion_v2.py:169:   输入 - text_length: 31 字符
[2025-12-29 16:41:21] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:21] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:41:22] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:41:22] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 3
[2025-12-29 16:41:22] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:41:22] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:41:22] INFO emotion_v2.py:201:   实体数量: 3
[2025-12-29 16:41:22] INFO emotion_v2.py:202:   实体列表: ['weather', 'beautiful', 'today']
[2025-12-29 16:41:22] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'weather' 生成情感描述
[2025-12-29 16:41:28] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, admiration, happiness, satisfaction
[2025-12-29 16:41:28] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'beautiful' 生成情感描述
[2025-12-29 16:41:32] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: admiration, joy, contentment, appreciation, delight
[2025-12-29 16:41:32] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'today' 生成情感描述
[2025-12-29 16:41:35] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: joy, contentment, admiration, delight
[2025-12-29 16:41:35] INFO sentence.py:120: Generated 3 affective descriptions for 3 entities
[2025-12-29 16:41:35] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:41:35] INFO emotion_v2.py:210:   成功生成: 3/3 个描述
[2025-12-29 16:41:35] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:41:35] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_002_entity_0, entity=weather, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:36] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_002_entity_1, entity=beautiful, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:37] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_002_entity_2, entity=today, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:37] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:41:37] INFO emotion_v2.py:274:   成功处理: 3/3 个实体
[2025-12-29 16:41:37] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:41:37] INFO emotion_v2.py:277:     1. entity_id=conv_002_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:41:37] INFO emotion_v2.py:277:     2. entity_id=conv_002_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:41:37] INFO emotion_v2.py:277:     3. entity_id=conv_002_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:41:37] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:41:37] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:41:37] INFO particle.py:115:   提取结果 - emotion_nodes数量: 3
[2025-12-29 16:41:37] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:41:37] INFO particle.py:119:     1. entity_id=conv_002_entity_0, entity=weather, vector_shape=(2048,)
[2025-12-29 16:41:37] INFO particle.py:119:     2. entity_id=conv_002_entity_1, entity=beautiful, vector_shape=(2048,)
[2025-12-29 16:41:37] INFO particle.py:119:     3. entity_id=conv_002_entity_2, entity=today, vector_shape=(2048,)
[2025-12-29 16:41:37] INFO particle.py:201: Successfully created 3 particles for text_id: conv_002
[2025-12-29 16:41:37] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 3 个粒子
[2025-12-29 16:41:37] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:41:37] INFO amygdala.py:316:   粒子 1/3: entity_id=conv_002_entity_0, entity=weather, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.02492007079560417, 0.015414940492141095, -0.02181910569660201, 0.013190335421117817, 0.0013756318439187528], born=1766997681.753389
[2025-12-29 16:41:37] INFO amygdala.py:316:   粒子 2/3: entity_id=conv_002_entity_1, entity=beautiful, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.025181767516445592, 0.013687689737161314, -0.0289198624446646, 0.009087820825490573, -0.005668695891146526], born=1766997681.753389
[2025-12-29 16:41:37] INFO amygdala.py:316:   粒子 3/3: entity_id=conv_002_entity_2, entity=today, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.023288627318117667, 0.015051711559291494, -0.0207856983914025, 0.012924220621583635, -0.0009969056708109734], born=1766997681.753389
[2025-12-29 16:41:37] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:41:37] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:41:37] INFO linking.py:72: Building hyperbolic links for 3 entities (threshold=2.0, top_k=10)
[2025-12-29 16:41:37] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:41:37] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:41:37] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:41:37] INFO amygdala.py:378:   粒子数量: 3
[2025-12-29 16:41:37] INFO amygdala.py:380:   粒子ID列表: ['conv_002_entity_0', 'conv_002_entity_1', 'conv_002_entity_2']
[2025-12-29 16:41:39] INFO storage.py:128: Batch upserted 3 entities
[2025-12-29 16:41:39] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 3 个粒子已存储到数据库
[2025-12-29 16:41:39] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:41:39] INFO amygdala.py:399:   conversation_id: conv_002
[2025-12-29 16:41:39] INFO amygdala.py:400:   对话内容长度: 31 字符
[2025-12-29 16:41:39] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:41:39] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:41:39] INFO amygdala.py:107:   文本 1: The weather is beautiful today. (长度: 31 字符)
[2025-12-29 16:41:39] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:41:39] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:41:39] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:41:40] INFO amygdala.py:95: Saved 2 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:41:40] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 2
[2025-12-29 16:41:40] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_002
[2025-12-29 16:41:40] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:41:40] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:41:40] INFO amygdala.py:428:   对话ID: conv_002
[2025-12-29 16:41:40] INFO amygdala.py:429:   关联粒子数: 3
[2025-12-29 16:41:40] INFO amygdala.py:430:   关系映射详情: {'conv_002_entity_0': 'conv_002', 'conv_002_entity_1': 'conv_002', 'conv_002_entity_2': 'conv_002'}
[2025-12-29 16:41:40] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:41:40] INFO amygdala.py:442:   对话ID: conv_002
[2025-12-29 16:41:40] INFO amygdala.py:443:   生成粒子数: 3
[2025-12-29 16:41:40] INFO amygdala.py:444:   粒子ID列表: ['conv_002_entity_0', 'conv_002_entity_1', 'conv_002_entity_2']
[2025-12-29 16:41:40] INFO amygdala.py:445:   关系映射数: 3
[2025-12-29 16:41:40] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:41:40] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:41:40] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:41:40] INFO amygdala.py:298:   输入 - conversation_id: conv_003
[2025-12-29 16:41:40] INFO amygdala.py:299:   输入 - conversation_text: Machine learning is fascinating.
[2025-12-29 16:41:40] INFO amygdala.py:300:   输入 - conversation_length: 32 字符
[2025-12-29 16:41:40] INFO particle.py:100: ================================================================================
[2025-12-29 16:41:40] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:41:40] INFO particle.py:102:   输入 - text_id: conv_003
[2025-12-29 16:41:40] INFO particle.py:103:   输入 - text: Machine learning is fascinating.
[2025-12-29 16:41:40] INFO particle.py:104:   输入 - text_length: 32 字符
[2025-12-29 16:41:40] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:40] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:41:40] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:41:40] INFO emotion_v2.py:167:   输入 - text_id: conv_003
[2025-12-29 16:41:40] INFO emotion_v2.py:168:   输入 - text: Machine learning is fascinating.
[2025-12-29 16:41:40] INFO emotion_v2.py:169:   输入 - text_length: 32 字符
[2025-12-29 16:41:40] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:40] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:41:41] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:41:41] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:41:41] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['Machine learning']
[2025-12-29 16:41:41] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:41:41] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:41:41] INFO emotion_v2.py:202:   实体列表: ['Machine learning']
[2025-12-29 16:41:41] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'Machine learning' 生成情感描述
[2025-12-29 16:41:43] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: fascination, curiosity, admiration, interest
[2025-12-29 16:41:43] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:41:43] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:41:43] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:41:43] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:41:43] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_003_entity_0, entity=Machine learning, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:43] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:41:43] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:41:43] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:41:43] INFO emotion_v2.py:277:     1. entity_id=conv_003_entity_0, entity=Machine learning, vector_shape=(2048,)
[2025-12-29 16:41:43] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:41:43] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:41:43] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:41:43] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:41:43] INFO particle.py:119:     1. entity_id=conv_003_entity_0, entity=Machine learning, vector_shape=(2048,)
[2025-12-29 16:41:43] INFO particle.py:201: Successfully created 1 particles for text_id: conv_003
[2025-12-29 16:41:43] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:41:43] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:41:43] INFO amygdala.py:316:   粒子 1/1: entity_id=conv_003_entity_0, entity=Machine learning, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[-0.017355379109193818, 0.01988590512511498, -0.026671298167806237, -0.003882566224427714, -0.0028748345180874273], born=1766997700.7287421
[2025-12-29 16:41:43] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:41:43] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:41:43] INFO linking.py:72: Building hyperbolic links for 1 entities (threshold=2.0, top_k=10)
[2025-12-29 16:41:43] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:41:43] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:41:43] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:41:43] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:41:43] INFO amygdala.py:380:   粒子ID列表: ['conv_003_entity_0']
[2025-12-29 16:41:45] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:41:45] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:41:45] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:41:45] INFO amygdala.py:399:   conversation_id: conv_003
[2025-12-29 16:41:45] INFO amygdala.py:400:   对话内容长度: 32 字符
[2025-12-29 16:41:45] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:41:45] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:41:45] INFO amygdala.py:107:   文本 1: Machine learning is fascinating. (长度: 32 字符)
[2025-12-29 16:41:45] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:41:45] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:41:45] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:41:45] INFO amygdala.py:95: Saved 3 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:41:45] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 3
[2025-12-29 16:41:45] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_003
[2025-12-29 16:41:45] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:41:45] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:41:45] INFO amygdala.py:428:   对话ID: conv_003
[2025-12-29 16:41:45] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:41:45] INFO amygdala.py:430:   关系映射详情: {'conv_003_entity_0': 'conv_003'}
[2025-12-29 16:41:46] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:41:46] INFO amygdala.py:442:   对话ID: conv_003
[2025-12-29 16:41:46] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:41:46] INFO amygdala.py:444:   粒子ID列表: ['conv_003_entity_0']
[2025-12-29 16:41:46] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:41:46] INFO amygdala.py:446: ================================================================================
[2025-12-29 16:41:46] INFO amygdala.py:296: ================================================================================
[2025-12-29 16:41:46] INFO amygdala.py:297: [Amygdala.add] 开始处理对话
[2025-12-29 16:41:46] INFO amygdala.py:298:   输入 - conversation_id: conv_004
[2025-12-29 16:41:46] INFO amygdala.py:299:   输入 - conversation_text: I'm working on a new project.
[2025-12-29 16:41:46] INFO amygdala.py:300:   输入 - conversation_length: 29 字符
[2025-12-29 16:41:46] INFO particle.py:100: ================================================================================
[2025-12-29 16:41:46] INFO particle.py:101: [Particle.process] 开始处理文本
[2025-12-29 16:41:46] INFO particle.py:102:   输入 - text_id: conv_004
[2025-12-29 16:41:46] INFO particle.py:103:   输入 - text: I'm working on a new project.
[2025-12-29 16:41:46] INFO particle.py:104:   输入 - text_length: 29 字符
[2025-12-29 16:41:46] INFO particle.py:105:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:46] INFO emotion_v2.py:165: ================================================================================
[2025-12-29 16:41:46] INFO emotion_v2.py:166: [EmotionV2.process] 开始处理文本
[2025-12-29 16:41:46] INFO emotion_v2.py:167:   输入 - text_id: conv_004
[2025-12-29 16:41:46] INFO emotion_v2.py:168:   输入 - text: I'm working on a new project.
[2025-12-29 16:41:46] INFO emotion_v2.py:169:   输入 - text_length: 29 字符
[2025-12-29 16:41:46] INFO emotion_v2.py:170:   输入 - entities: None (将自动抽取)
[2025-12-29 16:41:46] INFO emotion_v2.py:174: [EmotionV2.process] 开始抽取实体...
[2025-12-29 16:41:47] INFO emotion_v2.py:176: [EmotionV2.process] 实体抽取完成
[2025-12-29 16:41:47] INFO emotion_v2.py:177:   抽取结果 - 实体数量: 1
[2025-12-29 16:41:47] INFO emotion_v2.py:178:   抽取结果 - 实体列表: ['project']
[2025-12-29 16:41:47] INFO emotion_v2.py:200: [EmotionV2.process] 开始为实体生成情感描述...
[2025-12-29 16:41:47] INFO emotion_v2.py:201:   实体数量: 1
[2025-12-29 16:41:47] INFO emotion_v2.py:202:   实体列表: ['project']
[2025-12-29 16:41:47] INFO sentence.py:67: [Sentence.generate_affective_description] 开始为实体 'project' 生成情感描述
[2025-12-29 16:41:51] INFO sentence.py:78: [Sentence.generate_affective_description] 成功生成描述: anticipation, hope, engagement, curiosity, motivation
[2025-12-29 16:41:51] INFO sentence.py:120: Generated 1 affective descriptions for 1 entities
[2025-12-29 16:41:51] INFO emotion_v2.py:209: [EmotionV2.process] 情感描述生成完成
[2025-12-29 16:41:51] INFO emotion_v2.py:210:   成功生成: 1/1 个描述
[2025-12-29 16:41:51] INFO emotion_v2.py:226: [EmotionV2.process] 开始生成情绪嵌入向量...
[2025-12-29 16:41:52] INFO emotion_v2.py:257: [EmotionV2.process] 成功创建 EmotionNode: entity_id=conv_004_entity_0, entity=project, vector_shape=(2048,), vector_norm=1.000000
[2025-12-29 16:41:52] INFO emotion_v2.py:273: [EmotionV2.process] 处理完成
[2025-12-29 16:41:52] INFO emotion_v2.py:274:   成功处理: 1/1 个实体
[2025-12-29 16:41:52] INFO emotion_v2.py:275:   生成的 EmotionNode 列表:
[2025-12-29 16:41:52] INFO emotion_v2.py:277:     1. entity_id=conv_004_entity_0, entity=project, vector_shape=(2048,)
[2025-12-29 16:41:52] INFO emotion_v2.py:282: ================================================================================
[2025-12-29 16:41:52] INFO particle.py:114: [Particle.process] 情绪节点提取完成
[2025-12-29 16:41:52] INFO particle.py:115:   提取结果 - emotion_nodes数量: 1
[2025-12-29 16:41:52] INFO particle.py:117:   提取结果 - emotion_nodes详情:
[2025-12-29 16:41:52] INFO particle.py:119:     1. entity_id=conv_004_entity_0, entity=project, vector_shape=(2048,)
[2025-12-29 16:41:52] INFO particle.py:201: Successfully created 1 particles for text_id: conv_004
[2025-12-29 16:41:52] INFO amygdala.py:309: [Amygdala.add] 粒子生成完成: 1 个粒子
[2025-12-29 16:41:52] INFO amygdala.py:313: [Amygdala.add] 粒子详细信息:
[2025-12-29 16:41:52] INFO amygdala.py:316:   粒子 1/1: entity_id=conv_004_entity_0, entity=project, speed=0.500000, temperature=0.500000, weight=1.000000, emotion_vector_shape=(2048,), emotion_vector_preview=[0.009919465595527747, 0.02447868200186683, -0.041872030292642456, 0.013393564453869251, -0.009868040597624634], born=1766997706.3522537
[2025-12-29 16:41:52] INFO amygdala.py:354: [Amygdala.add] 开始构建粒子邻域链接
[2025-12-29 16:41:52] INFO amygdala.py:355:   参数: distance_threshold=2.0, top_k=10
[2025-12-29 16:41:52] INFO linking.py:72: Building hyperbolic links for 1 entities (threshold=2.0, top_k=10)
[2025-12-29 16:41:52] INFO linking.py:128: Built 0 links (average 0.00 per entity)
[2025-12-29 16:41:52] INFO amygdala.py:363: [Amygdala.add] 邻域链接构建完成: 0 条链接
[2025-12-29 16:41:52] INFO amygdala.py:377: [Amygdala.add] 开始存储粒子到数据库
[2025-12-29 16:41:52] INFO amygdala.py:378:   粒子数量: 1
[2025-12-29 16:41:52] INFO amygdala.py:380:   粒子ID列表: ['conv_004_entity_0']
[2025-12-29 16:41:55] INFO storage.py:128: Batch upserted 1 entities
[2025-12-29 16:41:55] INFO amygdala.py:386: [Amygdala.add] 粒子存储成功: 1 个粒子已存储到数据库
[2025-12-29 16:41:55] INFO amygdala.py:398: [Amygdala.add] 开始存储对话到数据库
[2025-12-29 16:41:55] INFO amygdala.py:399:   conversation_id: conv_004
[2025-12-29 16:41:55] INFO amygdala.py:400:   对话内容长度: 29 字符
[2025-12-29 16:41:55] INFO amygdala.py:104: [SimpleConversationStore.insert_strings] 开始插入对话文本
[2025-12-29 16:41:55] INFO amygdala.py:105:   输入文本数量: 1
[2025-12-29 16:41:55] INFO amygdala.py:107:   文本 1: I'm working on a new project. (长度: 29 字符)
[2025-12-29 16:41:55] INFO amygdala.py:124: [SimpleConversationStore.insert_strings] 插入统计: 1 条新记录, 0 条已存在
[2025-12-29 16:41:55] INFO amygdala.py:135: [SimpleConversationStore.insert_strings] 准备插入 1 条新记录
[2025-12-29 16:41:55] INFO amygdala.py:143: [SimpleConversationStore.insert_strings] 保存新记录到文件
[2025-12-29 16:41:55] INFO amygdala.py:95: Saved 4 conversation records to test_amygdala_integration/conversation_embeddings/vdb_test_conversation.parquet
[2025-12-29 16:41:56] INFO amygdala.py:145: [SimpleConversationStore.insert_strings] 插入完成，当前总记录数: 4
[2025-12-29 16:41:56] INFO amygdala.py:403: [Amygdala.add] 对话存储成功: conversation_id=conv_004
[2025-12-29 16:41:56] INFO amygdala.py:414: [Amygdala.add] 开始记录关系映射
[2025-12-29 16:41:56] INFO amygdala.py:427: [Amygdala.add] 关系映射记录完成:
[2025-12-29 16:41:56] INFO amygdala.py:428:   对话ID: conv_004
[2025-12-29 16:41:56] INFO amygdala.py:429:   关联粒子数: 1
[2025-12-29 16:41:56] INFO amygdala.py:430:   关系映射详情: {'conv_004_entity_0': 'conv_004'}
[2025-12-29 16:41:56] INFO amygdala.py:441: [Amygdala.add] 处理完成
[2025-12-29 16:41:56] INFO amygdala.py:442:   对话ID: conv_004
[2025-12-29 16:41:56] INFO amygdala.py:443:   生成粒子数: 1
[2025-12-29 16:41:56] INFO amygdala.py:444:   粒子ID列表: ['conv_004_entity_0']
[2025-12-29 16:41:56] INFO amygdala.py:445:   关系映射数: 1
[2025-12-29 16:41:56] INFO amygdala.py:446: ================================================================================
Traceback (most recent call last):
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 667, in test_amygdala_integration
    assert text is not None, f"对话 {conv_id} 的文本应该存在"
AssertionError: 对话 conv_001 的文本应该存在
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 743, in <module>
    main()
  File "/mnt/d/Codes/HyperAmy/test/test_amygdala.py", line 739, in main
    raise AssertionError(f"{failed} 个测试失败")
AssertionError: 2 个测试失败

【Step 5】测试长对话...
  ✓ 长对话处理成功: 1 个粒子

====================================================================================================
✓ 测试7完成：边界情况处理正常
====================================================================================================

✓ 边界情况 测试通过

====================================================================================================
测试8：集成测试
====================================================================================================

【Step 1】初始化 Amygdala...
✓ 初始化成功

【Step 2】添加多个对话...
  ✓ conv_001: 2 个粒子
  ✓ conv_002: 3 个粒子
  ✓ conv_003: 1 个粒子
  ✓ conv_004: 1 个粒子

【Step 3】验证所有功能...
  ✓ 验证了 7 个粒子的映射关系

❌ 测试8失败: 对话 conv_001 的文本应该存在

❌ 集成测试 测试失败: 对话 conv_001 的文本应该存在

====================================================================================================
测试总结
====================================================================================================
总测试数: 8
通过: 6
失败: 2
====================================================================================================
